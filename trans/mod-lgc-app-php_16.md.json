["```php\n**includes/services.php**\n1 <?php\n2 $di = new \\Mlaphp\\Di($GLOBALS);\n3 ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 // set a container service for the router\n3 $di->set('router', function () use ($di) {\n4 $router = new \\Mlaphp\\Router('/path/to/app/pages');\n5 $router->setRoutes(array());\n6 return $router;\n7 });\n8 ?>\n```", "```php\ndocroot/front.php\n1 <?php\n2 require dirname(__DIR__) . '/includes/setup.php';\n3 require dirname(__DIR__) . '/includes/services.php';\n4\n5 // get the shared router service\n6 $router = $di->get('router');\n7\n8 // match against the url path\n9 $path = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);\n10 $route = $router->match($path);\n11\n12 // container service, or page script?\n13 if ($di->has($route)) {\n14 // create a new $controller instance\n15 $controller = $di->newInstance($route);\n16 } else {\n17 // require the page script\n18 require $route;\n19 }\n20\n21 // invoke the controller and send the response\n22 $response = $controller->__invoke();\n23 $response->send();\n24 ?>\n```", "```php\n**pages/articles.php**\n1 <?php\n2 $db = new Database($db_host, $db_user, $db_pass);\n3 $articles_gateway = new ArticlesGateway($db);\n4 $users_gateway = new UsersGateway($db);\n5 $article_transactions = new ArticleTransactions(\n6 $articles_gateway,\n7 $users_gateway\n8 );\n9 $response = new \\Mlaphp\\Response('/path/to/app/views');\n10 $controller = new \\Controller\\ArticlesPage(\n11 $request,\n12 $response,\n13 $user,\n14 $article_transactions\n15 );\n16 ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 $di->set('Controller\\ArticlesPage', function () use ($di) {\n3 });\n4 ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 $di->set('Controller\\ArticlesPage', function () use ($di) {\n3 // replace `$variables` with `$di->` properties\n4 $db = new Database($di->db_host, $di->db_user, $di->db_pass);\n5 // create dependencies\n6 $articles_gateway = new ArticlesGateway($db);\n7 $users_gateway = new UsersGateway($db);\n8 $article_transactions = new ArticleTransactions(\n9 $articles_gateway,\n10 $users_gateway\n11 );\n12 $response = new \\Mlaphp\\Response('/path/to/app/views');\n13 // return the new instance\n14 return new \\Controller\\ArticlesPage(\n15 $request,\n16 $response,\n17 $user,\n18 $article_transactions\n19 );\n20 });\n21 ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 // ...\n3 $di->set('router', function () use ($di) {\n4 $router = new \\Mlaphp\\Router($di->pages_dir);\n5 $router->setRoutes(array(\n6 // add a route that points to a container service name\n7 '/articles.php' => 'Controller\\ArticlesPage',\n8 ));\n9 return $router;\n10 });\n11 ?>\n```", "```php\nincludes/services.php\n1 <?php\n2 // ...\n3\n4 $di->set('request', function () use ($di) {\n5 return new \\Mlaphp\\Request($GLOBALS);\n6 });\n7\n8 $di->set('response', function () use ($di) {\n9 return new \\Mlaphp\\Response('/path/to/app/views');\n10 });\n11\n12 $di->set('database', function () use ($di) {\n13 return new \\Database(\n14 $di->db_host,\n15 $di->db_user,\n16 $di->db_pass\n17 );\n18 });\n19\n20 $di->set('Domain\\Articles\\ArticlesGateway', function () use ($di) {\n21 return new \\Domain\\Articles\\ArticlesGateway($di->get('database'));\n22 });\n23\n24 $di->set('Domain\\Users\\UsersGateway', function () use ($di) {\n25 return new \\Domain\\Users\\UsersGateway($di->get('database'));\n26 });\n27\n28 $di->set('Domain\\Articles\\ArticleTransactions', function () use ($di) {\n29 return new \\Domain\\Articles\\ArticleTransactions(\n30 $di->newInstance('Domain\\Articles\\ArticlesGateway'),\n31 $di->newInstance('Domain\\Users\\UsersGateway'),\n32 );\n33 });\n34\n35 $di->set('Controller\\ArticlesPage', function () use ($di) {\n36 return new \\Controller\\ArticlesPage(\n37 $di->get('request'),\n38 $di->get('response'),\n39 $di->user,\n40 $di->newInstance('Domain\\Articles\\ArticleTransactions')\n41 );\n42 });\n43 ?>\n```", "```php\n**includes/routes.php**\n1 <?php return array(\n2 '/articles.php' => 'Controller\\ArticlesPage',\n3 ); ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 // ...\n3 $di->set('router', function () use ($di) {\n4 $router = new \\Mlaphp\\Router($di->pages_dir);\n5 $router->setRoutes(include '/path/to/includes/routes.php');\n6 return $router;\n7 });\n8 ?>\n```", "```php\n**classes/Di.php**\n1 <?php\n2 class Di extends \\Mlaphp\\Di\n3 {\n4 public function database()\n5 {\n6 return new \\Database(\n7 $this->db_host,\n8 $this->db_user,\n9 $this->db_pass\n10 );\n11 }\n12 }\n13 ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 $di->set('database', array($di, 'database'));\n3 ?>\n```", "```php\n**includes/services.php**\n1 <?php\n2 // ...\n3 $di->set('request', array($di, 'request'));\n4 $di->set('response', array($di, 'response'));\n5 $di->set('database', array($di, 'database'));\n6 $di->set('Domain\\Articles\\ArticlesGateway', array($di, 'ArticlesGateway'));\n7 $di->set('Domain\\Users\\UsersGateway', array($di, 'UsersGateway'));\n8 $di->set(\n9 'Domain\\Articles\\ArticleTransactions',\n10 array($di, 'ArticleTransactions')\n11 );\n12 $di->set('Controller\\ArticlesPage', array($di, 'ArticlesPage'));\n13 ?>\n```", "```php\n**classes/Di.php**\n1 <?php\n2 class Di extends \\Mlaphp\\Di\n3 {\n4 public function request()\n5 {\n6 return new \\Mlaphp\\Request($GLOBALS);\n7 }\n8\n9 public function response()\n10 {\n11 return new \\Mlaphp\\Response('/path/to/app/views');\n12 }\n13\n14 public function database()\n15 {\n16 return new \\Database(\n17 $this->db_host,\n18 $this->db_user,\n19 $this->db_pass\n20 );\n21 }\n22\n23 public function ArticlesGateway()\n24 {\n25 return new \\Domain\\Articles\\ArticlesGateway($this->get('database'));\n26 }\n27\n28 public function UsersGateway()\n29 {\n30 return new \\Domain\\Users\\UsersGateway($this->get('database'));\n31 }\n32\n33 public function ArticleTransactions()\n34 {\n35 return new \\Domain\\Articles\\ArticleTransactions(\n36 $this->newInstance('ArticlesGateway'),\n37 $this->newInstance('UsersGateway'),\n38 );\n39 }\n40\n41 public function ArticlesPage()\n42 {\n43 return new \\Controller\\ArticlesPage(\n44 $this->get('request'),\n45 $this->get('response'),\n46 $this->user,\n47 $this->newInstance('ArticleTransactions')\n48 );\n49 }\n50 }\n51 ?>\n```"]