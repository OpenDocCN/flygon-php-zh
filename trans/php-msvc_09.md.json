["```php\n**composer create-project --prefer-dist laravel/lumen private_messages**\n\n```", "```php\n    CREATE TABLE `messages` (\n      `id` INT NOT NULL AUTO_INCREMENT,\n      `sender_id` INT NULL,\n      `recipient_id` INT NULL,\n      `message` TEXT NULL,\n      PRIMARY KEY (`id`));\n```", "```php\n    DB_CONNECTION=mysql\n    DB_HOST=localhost\n    DB_PORT=3306\n    DB_DATABASE=**private_messages**\n    DB_USERNAME=root\n    DB_PASSWORD=root\n```", "```php\n    $app->run(\n      $app->make('request')\n    );\n```", "```php\n    $app->get('messages/user/{userId}',\n              'MessageController@getUserMessages');\n    $app->post('messages/sender/{senderId}/recipient/{recipientId}',\n               'MessageController@sendMessage');\n```", "```php\n    <?php\n\n    namespace App\\Http\\Controllers;\n\n    use Illuminate\\Http\\Request;\n\n    class MessageController extends Controller\n    {\n      public function getUserMessages(Request $request, $userId) {\n        // getUserMessages code\n      }\n\n      public function sendMessage(Request $request, $senderId,\n                                  $recipientId) {\n        // sendMessage code\n      }\n    }\n```", "```php\n    $app->withFacades();\n    $app->withEloquent();\n```", "```php\n    public function getUserMessages(Request $request, $userId) \n    {\n **$messages = Message::where('recipient_id',$userId)->get();**\n **return response()->json($messages);**\n    }\n\n    public function sendMessage(Request $request, $senderId,\n                                $recipientId) \n    {\n      **$message = new Message();**\n **$message->fill([\n        'sender_id'    => $senderId,\n        'recipient_id' => $recipientId,\n        'message'      => $request->input('message')]);**\n **$message->save();**\n **return response()->json([]);**\n    }\n```", "```php\n    <?php if (empty($arrUser['username'])) : ?>\n      <li role=\"presentation\"><a href=\"login.php\">Log in</a></li>\n      <li role=\"presentation\"><a href=\"signup.php\">Sign up</a></li>\n    <?php else : ?>\n      <?php if ($arrUser['type'] === 'admin') : ?>\n        <li role=\"presentation\">\n          <a href=\"admin/index.php\">Admin Panel</a>\n        </li>\n      <?php endif; ?>\n **<li role=\"presentation\">\n        <a href=\"messages.php\">Messages</a>\n      </li>**\n      <li role=\"presentation\">\n        <a href=\"index.php?logout=true\">Log out</a>\n      </li>\n    <?php endif; ?>\n```", "```php\n    <?\n      include_once 'libraries.php';\n\n      $url = \"http://localhost/private_messages/public/messages\n              /user/\".$arrUser['id'];\n      $ch = curl_init();\n      curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\n      curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n      curl_setopt($ch, CURLOPT_URL,$url);\n      $result=curl_exec($ch);\n      curl_close($ch);\n      $messages = json_decode($result, true);\n```", "```php\n    $arrUsers = array();\n    $query = \"SELECT id, username FROM `users` ORDER BY username ASC\";\n    $result = mysql_query ($query, $dbConn);\n    while ( $row = mysql_fetch_assoc ($result)) {\n      array_push( $arrUsers,$row );\n    }\n```", "```php\n **include_once 'header.php';\n    ?>**\n    <p class=\"bg-success\">\n **<?php if ($_GET['sent']) { ?>\n        The message was sent!\n      <?php } ?>**\n    </p>\n    <h1>Messages</h1>\n    <?php foreach($messages as $message) { ?>\n      <div class=\"panel panel-primary\">\n        <div class=\"panel-heading\">\n          <h3 class=\"panel-title\">\n            Message from **<?php echo $arrUsers[$message['sender_id']]\n                           ['username'];?>**           </h3>\n        </div>\n        <div class=\"panel-body\">\n **<?php echo $message['message']; ?>**        </div>\n      </div>\n **<?php } ?>**    <h1>Send message</h1>\n      <div>\n        <form action=\"messages.php\" method=\"post\">\n          <div class=\"form-group\">\n            <label for=\"category_id\">Recipient</label>\n            <select class=\"form-control\" name=\"recipient\">\n              <option value=\"\">Select User</option>\n              <option value=\"\">------------------------</option>\n **<?php foreach($arrUsers as $user) { ?>**                <option value=\"**<?php echo $user['id']; ?>**\">\n **<?php echo $user['username']; ?>**\n                </option>\n **<?php } ?>**            </select>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"name\">\n              Message\n            </label>\n            <br />\n            <input name=\"message\" type=\"text\" value=\"\"\n             class=\"form-control\" />\n          </div>\n          <input name=\"sender\" type=\"hidden\" \n           value=\"<?php echo $arrUser['id']; ?>\" />\n\n          <div class=\"form-group\">\n            <input name=\"submit\" type=\"submit\" value=\"Send message\" \n             class=\"btn btn-primary\" />\n          </div>\n\n        </form>\n      </div>\n **<?php include_once 'footer.php'; ?>**\n\n```", "```php\n    if (!empty($_POST['submit'])) {\n      if (!empty($_POST['sender'])) {\n        $sender = $_POST['sender'];\n      }\n      if (!empty($_POST['recipient'])) {\n        $recipient = $_POST['recipient'];\n      }\n      if (!empty($_POST['message'])) {\n        $message = $_POST['message'];\n      }\n\n      if (empty($sender)) {\n        $error['sender'] = 'Sender not found';\n      }\n      if (empty($recipient)) {\n        $error['recipient'] = 'Please select a recipient';\n      }\n      if (empty($message)) {\n        $error['message'] = 'Please complete the message';\n      }\n\n      if (empty($error)) {\n        $url = 'http://localhost/private_messages/public/messages\n                /sender/'.$sender.'/recipient/'.$recipient;\n\n        $handler = curl_init();\n        curl_setopt($handler, CURLOPT_URL, $url);\n        curl_setopt($handler, CURLOPT_POST,true);\n        curl_setopt($handler, CURLOPT_RETURNTRANSFER,true);\n        curl_setopt($handler, CURLOPT_POSTFIELDS, \"message=\".$message);\n        $response = curl_exec ($handler);\n\n        curl_close($handler);\n\n        header( 'Location: messages.php?sent=true' );\n        die;\n      }\n    }\n```", "```php\n    <?php\n\n    class Controller\n    {\n      public function connect () {\n        $db_con = mysql_pconnect(DB_SERVER,DB_USER,DB_PASS);\n        if (!$db_con) {\n          return false;\n        }\n        if (!mysql_select_db(DB_NAME, $db_con)) {\n          return false;\n        }\n        return $db_con;\n      }\n\n      public function **getArticle**($id)\n      {\n        $dbConn = $this->connect();\n\n        $query = \"SELECT articles.id, articles.title, articles.extract,\n                         articles.text, articles.updated_at, \n                         categories.value as category,\n                         users.username FROM `articles`\n                  INNER JOIN \n                  `categories` ON categories.id = articles.category_id\n                  INNER JOIN\n                  `users` ON users.id = articles.user_id\n                  WHERE articles.id = \" . $id . \" LIMIT 1\";\n        $result = mysql_query ($query, $dbConn);\n        return mysql_fetch_assoc ($result);\n      }\n\n      public function **getArticleComments**($id)\n      {\n        $dbConn = $this->connect();\n\n        $arrComments = array();\n        $query = \"SELECT comments.id, comments.comment, users.username\n                  FROM `comments` INNER JOIN `users`\n                  ON comments.user_id = users.id\n                  WHERE comments.status = 'valid'\n                  AND comments.article_id = \" . $id . \"\n                  ORDER BY comments.id DESC\";\n\n        $result = mysql_query ($query, $dbConn);\n        while ($row = mysql_fetch_assoc($result)) {\n          array_push($arrComments,$row);\n        }\n\n        return $arrComments;\n      }\n\n      public function **postComment**($comment,$user_id,$article_id)\n      {\n        $dbConn = $this->connect();\n\n        $query = \"INSERT INTO `comments` (comment, user_id, article_id)\n                  VALUES ('$comment','$user_id','$article_id')\";\n        mysql_query($query, $dbConn);\n      }\n    }\n```", "```php\n    <?\n      include_once 'libraries.php';\n **include_once 'Controller.php';**\n **$controller = new Controller();**\n\n      if ( !empty($_POST['submit']) ) {\n\n        // Validation\n        if (!empty($_POST['comment'])) {\n          $comment = $_POST['comment'];\n        }\n        if (!empty($_GET['id'])) {\n          $article_id = $_GET['id'];\n        }\n        if (!empty($arrUser['id'])) {\n          $user_id = $arrUser['id'];\n        }\n\n        if (empty($comment)) {\n          $error['comment'] = true;\n        }\n        if (empty($article_id)) {\n          $error['article_id'] = true;\n        }\n        if (empty($user_id)) {\n          $error['user_id'] = true;\n        }\n        if ( empty($error) ) {\n\n **$controller->postComment($comment,$user_id,$article_id);**\n          header ( 'Location: article.php?id='.$article_id);\n          die;\n        }\n      }\n\n **$article = $controller->getArticle($_GET['id']);**\n **$comments = $controller->getArticleComments($_GET['id']);**\n\n      include_once 'header.php';\n    ?>\n\n    <h1>Article</h1>\n\n    <div class=\"panel panel-primary\">\n      <div class=\"panel-heading\">\n        <h3 class=\"panel-title\">\n **<?php echo $article['title']; ?>**\n        </h3>\n      </div>\n      <div class=\"panel-body\">\n        <span class=\"label label-primary\">Published</span> by\n        <b>**<?php echo $article['username']; ?>**</b> in\n        <i>**<?php echo $article['category']; ?>**</i>\n        <b>**<?php echo date_format(date_create($article\n                                              ['fModificacion']),\n                                  'd/m/y h:m'); ?>**         </b>\n        <hr/>\n **<?php echo $article['text']; ?>**      </div>\n    </div>\n\n    <h2>Comments</h2>\n **<?php foreach ($comments as $comment) { ?>** \n      <div class=\"panel panel-warning\">\n        <div class=\"panel-heading\">\n          <h3 class=\"panel-title\">**<?php echo $comment['username']; ?>**                                   said</h3>\n        </div>\n        <div class=\"panel-body\">\n **<?php echo $comment['comment']; ?>**        </div>\n      </div>\n **<?php } ?>** \n    <div>\n **<?php if ( !empty( $arrUser ) ) { ?>** \n        <form action=\"article.php?id=**<?php echo $_GET['id']; ?>**\"\n              method=\"post\">\n          <div class=\"form-group\">\n            <label for=\"user\">Post a comment</label>\n            <textarea class=\"form-control\" rows=\"3\" cols=\"50\"\n                      name=\"comment\" id=\"comment\"> \n            </textarea>\n          </div>\n\n          <div class=\"form-group\">\n            <input name=\"submit\" type=\"submit\" value=\"Send\"\n                   class=\"btn btn-primary\" />\n          </div>\n        </form>\n\n **<?php } else { ?>**        <p>\n          Please sign up to leave a comment on this article. \n          <a href=\"signup.php\">Sign up</a> or\n          <a href=\"login.php\">Log in</a>\n        </p>\n **<?php } ?>**    </div>\n\n    <?php include_once 'footer.php'; ?>\n```", "```php\n    <?\n\n      session_start ();\n\n      require_once 'config.php';\n      require_once 'connection.php';\n      require_once 'isUser.php';\n\n **include_once '../Controller.php';**\n **$controller = new Controller();**\n      $dbConn = connect();\n\n      /* Omitted code */\n\n      if (!empty($_GET['del'])) {\n **$controller->deleteCategory($_GET['del']);**\n\n        header( 'Location: categories.php?dele=true' );\n        die;\n      }\n\n      if (!empty($_POST['submit'])) {\n        if (!empty($_POST['name'])) {\n          $name = $_POST['name'];\n        }\n        if (empty($name)) {\n          $error['name'] = 'Please enter category name';\n        }\n        if (empty($error)) {\n **$controller->createCategory($name);**\n          header( 'Location: categories.php?add=true' );\n          die;\n        }\n      }\n\n      if (!empty($_POST['submitEdit'])) {\n\n        /* Ommited code */\n\n        if (empty($error)) {\n **$controller->updateCategory($id, $name);**\n          header( 'Location: categories.php?edit=true' );\n          die;\n        }\n      }\n\n **$arrCategories = $controller->getCategories();**\n\n      if (!empty($_GET['id'])) {\n **$row = $controller->getCategory($_GET['id']);**\n      }\n\n      include_once 'header.php';\n\n    ?>\n    <!-- Omitted HTML code -->\n\n```", "```php\n    public function createCategory($name)\n    {\n      $dbConn = $this->connect();\n\n      $query = \"INSERT INTO `categories` (value) VALUES ('$name')\";\n      mysql_query($query, $dbConn);\n    }\n\n    public function updateCategory($id,$name)\n    {\n      $dbConn = $this->connect();\n\n      $query = \"UPDATE `categories` set value = '$name'\n                WHERE id = $id\";\n      mysql_query($query, $dbConn);\n    }\n\n    public function deleteCategory($id)\n    {\n      $dbConn = $this->connect();\n\n      $query = \"DELETE FROM `categories` WHERE id = \".$id;\n      mysql_query($query, $dbConn);\n    }\n\n    public function getCategories()\n    {\n      $dbConn = $this->connect();\n\n      $arrCategories = array();\n\n      $query = \"SELECT id, value FROM `categories` ORDER BY value ASC\";\n      $resultado = mysql_query ($query, $dbConn);\n\n      while ($row = mysql_fetch_assoc ($resultado)) {\n        array_push( $arrCategories,$row );\n      }\n\n      return $arrCategories;\n    }\n\n    public function getCategory($id)\n    {\n      $dbConn = $this->connect();\n\n      $query = \"SELECT id, value FROM `categories` WHERE id = \".$id;\n      $resultado = mysql_query ($query, $dbConn);\n      return mysql_fetch_assoc ($resultado);\n    }\n```", "```php\n    include_once '../Controller.php';\n    $controller = new Controller();\n```", "```php\n    $arrCategories = $controller->getCategories();\n```", "```php\n    SELECT articles.id, articles.title, articles.extract,\n           articles.text, articles.updated_at,\n           categories.value as category,\n           users.username FROM `articles`\n **INNER JOIN `categories` ON categories.id = articles.category_id** \n    INNER JOIN `users` ON users.id = articles.user_id \n    WHERE articles.id = \" . $id . \" LIMIT 1;\n```", "```php\n    SELECT articles.id, articles.title, articles.extract,\n           articles.text, articles.updated_at, articles.category_id,\n           users.username FROM `articles` \n    INNER JOIN `users` ON users.id = articles.user_id \n    WHERE articles.id = \" . $id . \" LIMIT 1;\n```", "```php\n    public function getArticle($id)\n    {\n      $dbConn = $this->connect();\n\n      $query = \"SELECT articles.id, articles.title, articles.extract,\n                       articles.text, articles.updated_at,\n                       articles.category_id,\n                       users.username FROM `articles`\n                INNER JOIN `users` ON users.id = articles.user_id\n                WHERE articles.id = \" . $id . \" LIMIT 1;\";\n\n      $result = mysql_query ($query, $dbConn);\n\n      $data = mysql_fetch_assoc($result);\n **$data['category'] = $this->getCategory($data['category_id']);**\n **$data['category'] = $data['category']['value'];**\n      return $data;\n    }\n```", "```php\n**composer create-project --prefer-dist laravel/lumen categories**\n\n```", "```php\n    DB_CONNECTION=mysql\n    DB_HOST=localhost\n    DB_PORT=3306\n    DB_DATABASE=**categories**\n    DB_USERNAME=root\n    DB_PASSWORD=root\n```", "```php\n **$app->run(**\n **$app->make('request')**\n **);**\n\n```", "```php\n    $app->withFacades();\n    $app->withEloquent();\n```", "```php\n    <?php\n\n      namespace App\\Model;\n\n      use Illuminate\\Database\\Eloquent\\Model;\n\n      class Category extends Model {\n        protected $table = 'categories';\n        protected $fillable = ['value'];\n        public $timestamps = false;\n      }\n```", "```php\n    <?php\n\n      namespace App\\Http\\Controllers;\n\n      use App\\Model\\Category;\n      use Illuminate\\Http\\Request;\n\n      class CategoryController extends Controller\n      {\n        public function **createCategory**(Request $request) {\n          $category = new Category();\n          $category->fill(['value' => $request->input('value')]);\n          $category->save();\n\n          return response()->json([]);\n        }\n\n        public function **updateCategory**(Request $request, $id) {\n          $category = Category::find($id);\n          $category->value = $request->input('value');\n          $category->save();\n\n          return response()->json([]);\n        }\n\n        public function **deleteCategory**(Request $request, $id) {\n          $category = Category::find($id);\n          $category->delete();\n\n          return response()->json([]);\n        }\n\n        public function **getCategories**(Request $request) {\n          $categories = Category::get();\n\n          return $categories;\n        }\n\n        public function **getCategory**(Request $request, $id) {\n          $category = Category::find($id);\n\n          return $category;\n        }\n      }\n```", "```php\n    function call($url, $method, $field = null)\n    {\n      $ch = curl_init();\n      if(($method == 'DELETE') || ($method == 'PUT')) {\n        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $method);\n      }\n      curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\n      curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n      curl_setopt($ch, CURLOPT_URL,$url);\n      if ($method == 'POST') {\n        curl_setopt($ch, CURLOPT_POST,true);\n      }\n      if($field) {\n        curl_setopt($ch, CURLOPT_POSTFIELDS, 'value='.$field);\n      }\n      $result=curl_exec($ch);\n      curl_close($ch);\n      return json_decode($result, true);\n    }\n```", "```php\n     $controller->call('http://localhost/categories/public/category', \n                       'POST', $name);\n```", "```php\n $controller->call('http://localhost/categories/public/category/'.$id,\n                   'PUT', $name);\n```", "```php\n    $controller->call('http://localhost/categories/public\n                       /category/'.$_GET['del'], 'DELETE');\n```", "```php\n$arrCategories = $controller->call('http://localhost/categories\n                                    /public/categories', 'GET');\n```", "```php\n$row = $controller->call('http://localhost/categories\n                          /public/category/'.$_GET['id'], 'GET');\n```", "```php\n    DROP TABLE categories;\n```"]