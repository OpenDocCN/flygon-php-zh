["```php\n    pecl channel-update pecl.php.net\n    ```", "```php\n    pecl install -D \\\n    \u00a0\u00a0\u00a0\u00a0'enable-sockets=\"yes\" \\\n    \u00a0\u00a0\u00a0\u00a0\u00a0enable-openssl=\"no\" \\\n    \u00a0\u00a0\u00a0\u00a0\u00a0enable-http2=\"no\" \\\n    \u00a0\u00a0\u00a0\u00a0\u00a0enable-mysqlnd=\"no\" \\\n    \u00a0\u00a0\u00a0\u00a0\u00a0enable-swoole-json=\"yes\" \\\n    \u00a0\u00a0\u00a0\u00a0\u00a0enable-swoole-curl=\"yes\"' \\\n    \u00a0\u00a0\u00a0\u00a0\u00a0swoole\n    ```", "```php\n    root@php8_tips_php8 [ / ]# pecl install swoole\n    downloading swoole-4.6.7.tgz ...\n    Starting to download swoole-4.6.7.tgz (1,649,407 bytes)\n    .....................................................................................................................................................................................................................................................................................................................................done: 1,649,407 bytes\n    364 source files, building\n    running: phpize\n    Configuring for:\n    PHP Api Version:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a020200930\n    Zend Module Api No:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a020200930\n    Zend Extension Api No:\u00a0\u00a0\u00a0420200930\n    building in /tmp/pear/temp/pear-build-defaultuserQakGt8/swoole-4.6.7\n    running: /tmp/pear/temp/swoole/configure --with-php-config=/usr/bin/php-config --enable-sockets=no --enable-openssl=no --enable-http2=no --enable-mysqlnd=yes --enable-swoole-json=yes --enable-swoole-curl=yes\n    ...\n    Build process completed successfully\n    Installing '/usr/include/php/ext/swoole/config.h'\n    Installing '/usr/lib/php/extensions/no-debug-non-zts-20200930/swoole.so'\n    install ok: channel://pecl.php.net/swoole-4.6.7\n    configuration option \"php_ini\" is not set to php.ini location\n    You should add \"extension=swoole.so\" to php.ini\n    ```", "```php\n    echo \"extension=swoole\" >>/etc/php.ini\n    ```", "```php\n    php --ri swoole\n    ```", "```php\n    version: \"3\"\n    services:\n    \u00a0\u00a0...\n    \u00a0\u00a0php8-tips-php8:\n    \u00a0\u00a0\u00a0\u00a0...\n    \u00a0\u00a0\u00a0\u00a0ports:\n    \u00a0\u00a0\u00a0\u00a0\u00a0- 8888:80\n    \u00a0\u00a0\u00a0\u00a0\u00a0- 9501:9501\n    \u00a0\u00a0\u00a0\u00a0...\n    ```", "```php\n    /path/to/repo/init.sh down\n    /path/to/repo/init.sh up\n    ```", "```php\n    $ docker exec -it php8_tips_php8 /bin/bash\n    # cd /repo/ch12\n    # php php8_swoole_hello_world.php\n    ```", "```php\n    // /repo/src/Chat/Messsage/Api.php;\n    namespace Chat\\Message;\n    use Chat\\Handler\\ {GetHandler, PostHandler,\n    \u00a0\u00a0\u00a0\u00a0NextHandler,GetAllNamesHandler,DeleteHandler};\n    use Chat\\Middleware\\ {Access,Validate,ValidatePost};\n    use Chat\\Message\\Render;\n    use Psr\\Http\\Message\\ServerRequestInterface;\n    class Pipe {\n    ```", "```php\n    public static function exec(\n    \u00a0\u00a0\u00a0\u00a0ServerRequestInterface $request) {\n    \u00a0\u00a0\u00a0\u00a0$params\u00a0\u00a0\u00a0= $request->getQueryParams();\n    \u00a0\u00a0\u00a0\u00a0$method\u00a0\u00a0\u00a0= strtolower($request->getMethod());\n    \u00a0\u00a0\u00a0\u00a0$dontcare = (new Access())\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0->process($request, new NextHandler());\n    ```", "```php\n    \u00a0\u00a0\u00a0\u00a0$response = match ($method) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'post' => (new ValidatePost())\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0->process($request, new PostHandler()),\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'delete' => (new DeleteHandler())\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0->handle($request),\n    ```", "```php\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'get'\u00a0\u00a0\u00a0\u00a0=> (!empty($params['all'])\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0? (new GetAllNamesHandler())->handle($request)\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: (new Validate())->process($request, \n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0new GetHandler())),\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0default => (new Validate())\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0->process($request, new GetHandler())};\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return Render::output($request, $response);\n    \u00a0\u00a0\u00a0\u00a0}\n    }\n    ```", "```php\n    // /repo/ch12/php8_chat_ajax.php\n    include __DIR__ . '/vendor/autoload.php';\n    use Laminas\\Diactoros\\ServerRequestFactory;\n    use Chat\\Message\\Pipe;\n    $request\u00a0\u00a0= ServerRequestFactory::fromGlobals();\n    $response = Pipe::exec($request);\n    echo $response;\n    ```", "```php\nroot@php8_tips_php8_1 [ /repo/ch12 ]# php php8_chat_test.php \\\n\u00a0\u00a0\u00a0\u00a0\u00a0http://localhost/ch12/php8_chat_ajax.php 10000\u00a0\u00a0bboyer :\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Dubai:AE:2956587 : 2021-01-01 00:00:00\n1 fcompton :\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Sharjah:AE:1324473 : 2022-02-02 01:01:01\n...\n998 hrivas : Caloocan City:PH:1500000 : 2023-03-19 09:54:54\n999\u00a0\u00a0lpena :\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Budta:PH:1273715 : 2021-04-20 10:55:55\nFrom User: dwallace\nElapsed Time: 3.3177478313446\n```", "```php\n# php /repo/ch10/php8_jit_reset.php on \n```", "```php\n# php /repo/ch10/php8_jit_reset.php off \n```", "```php\n    // /repo/ch12/php8_chat_swoole.php\n    include __DIR__ . '/vendor/autoload.php';\n    use Chat\\Message\\Pipe;\n    use Chat\\Http\\SwooleToPsr7;\n    use Swoole\\Http\\Server;\n    use Swoole\\Http\\Request;\n    use Swoole\\Http\\Response;\n    ```", "```php\n    session_start();\n    $server = new Swoole\\HTTP\\Server('0.0.0.0', 9501);\n    ```", "```php\n    $server->on(\"start\", function (Server $server) {\n    \u00a0\u00a0\u00a0\u00a0error_log('Swoole http server is started at '\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0. 'http://0.0.0.0:9501');\n    });\n    ```", "```php\n    $server->on(\"request\", function (\n    \u00a0\u00a0\u00a0\u00a0Request $swoole_request, Response $swoole_response){\n    \u00a0\u00a0\u00a0\u00a0$request\u00a0\u00a0= SwooleToPsr7::\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0swooleRequestToServerRequest($swoole_request);\n    \u00a0\u00a0\u00a0\u00a0$swoole_response->header(\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Content-Type\", \"text/plain\");\n    \u00a0\u00a0\u00a0\u00a0$response = Pipe::exec($request);\n    \u00a0\u00a0\u00a0\u00a0$swoole_response->end($response);\n    }); \n    $server->start();\n    ```", "```php\n    # cd /repo/ch12\n    # php php8_chat_swoole.php \n    Swoole http server is started at http://0.0.0.0:9501\n    ```", "```php\n    # cd /repo/ch12\n    # php php8_chat_test.php http://localhost:9501 1000\n    ```", "```php\nroot@php8_tips_php8_1 [ /repo/ch12 ]# php php8_chat_test.php \\\n\u00a0\u00a0\u00a0\u00a0\u00a0http://localhost:9501 1000\n0\u00a0\u00a0\u00a0\u00a0coconnel :\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Dubai:AE:2956587 :\u00a0\u00a02021-01-01 00:00:00\n1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0htyler :\u00a0\u00a0\u00a0\u00a0Sharjah:AE:1324473 :\u00a0\u00a02022-02-02 01:01:01\n...\n998\u00a0\u00a0cvalenci : Caloocan City:PH:1500 :\u00a0\u00a02023-03-19 09:54:54\n999\u00a0\u00a0smccormi :\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Budta:PH:1273715 :\u00a0\u00a02021-04-20 10:55:55\nFrom User: ajenkins\nElapsed Time: 1.8595671653748\n```", "```php\n    cd /repo/ch12\n    composer require --ignore-platform-reqs react/event-loop\n    composer require --ignore-platform-reqs react/http\n    composer require --ignore-platform-reqs react/socket\n    ```", "```php\n    // /repo/ch12/php8_chat_react.php\n    include __DIR__ . '/vendor/autoload.php';\n    use Chat\\Message\\Pipe;\n    use React\\EventLoop\\Factory;\n    use React\\Http\\Server;\n    use React\\Http\\Message\\Response as ReactResponse;\n    use Psr\\Http\\Message\\ServerRequestInterface;\n    ```", "```php\n    session_start();\n    $loop = Factory::create();\n    ```", "```php\n    $server = new Server($loop, \n    function (ServerRequestInterface $request) {\n    \u00a0\u00a0\u00a0\u00a0return new ReactResponse(200,\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0['Content-Type' => 'text/plain'],\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<8 SPACES>Pipe::exec($request)\n    \u00a0\u00a0\u00a0\u00a0);\n    });\n    ```", "```php\n    $socket = new React\\Socket\\Server(9501, $loop);\n    $server->listen($socket);\n    echo \"Server running at http://locahost:9501\\n\";\n    $loop->run();\n    ```", "```php\n    composer require mezzio/mezzio-swoole\n    ```", "```php\n    /path/to/project/vendor/bin/laminas mezzio:swoole:start\n    ```", "```php\n    return [\n    \u00a0\u00a0\u00a0\u00a0'mezzio-swoole' => [\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'swoole-http-server' => [\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'host' => '0.0.0.0',\u00a0\u00a0\u00a0\u00a0// all IP addresses\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'port' => 9501,\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n    \u00a0\u00a0\u00a0\u00a0],\n    ];\n    ```", "```php\nfinal class Fiber {\n\u00a0\u00a0\u00a0\u00a0public function __construct(callable $callback) {}\n\u00a0\u00a0\u00a0\u00a0public function start(mixed ...$args): mixed {}\n\u00a0\u00a0\u00a0\u00a0public function resume(mixed $value = null): mixed {}\n\u00a0\u00a0\u00a0\u00a0public function throw(Throwable $exception): mixed {}\n\u00a0\u00a0\u00a0\u00a0public function isStarted(): bool {}\n\u00a0\u00a0\u00a0\u00a0public function isSuspended(): bool {}\n\u00a0\u00a0\u00a0\u00a0public function isRunning(): bool {}\n\u00a0\u00a0\u00a0\u00a0public function isTerminated(): bool {}\n\u00a0\u00a0\u00a0\u00a0public function getReturn(): mixed {}\n\u00a0\u00a0\u00a0\u00a0public static function this(): ?self {}\n\u00a0\u00a0\u00a0\u00a0public static function suspend(\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0mixed $value = null): mixed {}\n}\n```", "```php\n    // /repo/ch12/php8_fibers_include.php\n    define('WAR_AND_PEACE',\n    \u00a0\u00a0\u00a0\u00a0'https://www.gutenberg.org/files/2600/2600-0.txt');\n    define('DB_FILE', __DIR__ \n    \u00a0\u00a0\u00a0\u00a0. '/../sample_data/geonames.db');\n    define('ACCESS_LOG', __DIR__ . '/access.log');\n    $callbacks = [\n    \u00a0\u00a0\u00a0\u00a0'read_url' => function (string $url) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return file_get_contents($url); },\n    \u00a0\u00a0\u00a0\u00a0'db_query' => function (string $iso2) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$pdo = new PDO('sqlite:' . DB_FILE);\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$sql = 'SELECT * FROM geonames '\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0. 'WHERE country_code = ?'\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$stmt = $pdo->prepare($sql);\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$stmt->execute([$iso2]);\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return var_export(\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$stmt->fetchAll(PDO::FETCH_ASSOC), TRUE);\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n    \u00a0\u00a0\u00a0\u00a0'access_log' => function (string $info) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$info = date('Y-m-d H:i:s') . \": $info\\n\";\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return file_put_contents(\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ACCESS_LOG, $info, FILE_APPEND);\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n    ];\n    return $callbacks;\n    ```", "```php\n    // /repo/ch12/php8_fibers_blocked.php\n    $start = microtime(TRUE);\n    $callbacks = include __DIR__ . '/php8_fibers_include.php';\n    foreach ($callbacks as $key => $exec) {\n    \u00a0\u00a0\u00a0\u00a0$info = match ($key) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'read_url' => WAR_AND_PEACE,\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'db_query' => 'IN',\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'access_log' => __FILE__,\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0default => ''\n    \u00a0\u00a0\u00a0\u00a0};\n    \u00a0\u00a0\u00a0\u00a0$result = $exec($info);\n    \u00a0\u00a0\u00a0\u00a0echo \"Executing $key\" . strlen($result) . \"\\n\";\n    }\n    echo \"Elapsed Time:\" . (microtime(TRUE) - $start) . \"\\n\";\n    ```", "```php\nroot@php8_tips_php8_1 [ /repo/ch12 ]# \nphp php8_fibers_blocked.php \nExecuting read_url:\u00a0\u00a0\u00a0\u00a0\u00a03359408\nExecuting db_query:\u00a0\u00a0\u00a0\u00a0\u00a023194\nExecuting access_log:\u00a0\u00a0\u00a0\u00a0\u00a02\nElapsed Time:6.0914640426636\n```", "```php\n    // /repo/ch12/php8_fibers_unblocked.php\n    $start = microtime(TRUE);\n    $callbacks = include __DIR__ \n    \u00a0\u00a0\u00a0\u00a0. '/php8_fibers_include.php';\n    ```", "```php\n    $fibers = [];\n    foreach ($callbacks as $key => $exec) {\n    \u00a0\u00a0\u00a0\u00a0$info = match ($key) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'read_url' => WAR_AND_PEACE,\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'db_query' => 'IN',\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'access_log' => __FILE__,\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0default => ''\n    \u00a0\u00a0\u00a0\u00a0};\n    \u00a0\u00a0\u00a0\u00a0$fibers[$key] = new Fiber($exec);\n    \u00a0\u00a0\u00a0\u00a0$fibers[$key]->start($info);\n    }\n    ```", "```php\n    $count\u00a0\u00a0= count($fibers);\n    $names\u00a0\u00a0= array_keys($fibers);\n    while ($count) {\n    \u00a0\u00a0\u00a0\u00a0$count = 0;\n    \u00a0\u00a0\u00a0\u00a0foreach ($names as $name) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if ($fibers[$name]->isTerminated()) {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$result = $fibers[$name]->getReturn();\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0echo \"Executing $name: \\t\" \n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0. strlen($result) . \"\\n\";\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0unset($names[$name]);\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0} else {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$count++;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n    \u00a0\u00a0\u00a0\u00a0}\n    }\n    echo \"Elapsed Time:\" . (microtime(TRUE) - $start) . \"\\n\";\n    ```", "```php\n    # cd /repo/ch12\n    ```", "```php\n    # php -S localhost:9501 php8_chat_ajax.php\n    ```", "```php\n    php php8_chat_test.php http://localhost:9501 1000 --no\n    ```", "```php\nroot@php8_tips_php8_1 [ /repo/ch12 ]# \nphp php8_chat_test.php http://localhost:9501 1000 --no\nFrom User: pduarte\nElapsed Time: 1.687940120697\n```", "```php\n    # php php8_chat_react.php\n    ```", "```php\n    php php8_chat_test.php http://localhost:9501 1000 --no\n    ```", "```php\nroot@php8_tips_php8_1 [ /repo/ch12 ]# \nphp php8_chat_test.php http://localhost:9501 1000 --no\nFrom User: klang\nElapsed Time: 1.2330160140991\n```"]