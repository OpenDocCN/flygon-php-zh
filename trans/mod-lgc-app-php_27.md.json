["```php\n**articles.php**\n1 <?php\n2 require \"includes/setup.php\";\n3\n4 /* DEPENDENCY */\n5\n6 $db = new Database($db_host, $db_user, $db_pass);\n7 $articles_gateway = new ArticlesGateway($db);\n8 $users_gateway = new UsersGateway($db);\n9 $article_transactions = new ArticleTransactions(\n10 $articles_gateway,\n11 $users_gateway\n12 );\n13 $response = new \\Mlaphp\\Response('/path/to/app/views');\n14 $controller = new \\Controller\\ArticlesPage(\n15 $request,\n16 $response,\n17 $user,\n18 $article_transactions\n19 );\n20\n21 /* CONTROLLER */\n22\n23 $response = $controller->__invoke();\n24\n25 /* FINISHED */\n26\n27 $response->send();\n28 ?>\n```", "```php\n**classes/Controller/ArticlesPage.php**\n1 <?php\n2 namespace Controller;\n3\n4 use Domain\\Articles\\ArticleTransactions;\n5 use Mlaphp\\Request;\n6 use Mlaphp\\Response;\n7 use User;\n8\n9 class ArticlesPage\n10 {\n11 protected $user;\n12\n13 protected $article_transactions;\n14\n15 protected $request;\n16\n17 protected $response;\n18\n19 public function __construct(\n20 Request $request,\n21 Response $response,\n22 User $user,\n23 ArticleTransactions $article_transactions\n24 ) {\n25 $this->user = $user;\n26 $this->article_transactions = $article_transactions;\n27 $this->request = $request;\n28 $this->response = $response;\n29 }\n30\n31 public function __invoke()\n32 {\n33 $user_id = $this->user->getId();\n34\n35 $id = isset($this->request->get['id'])\n36 ? $this->request->get['id']\n37 : 0;\n38\n39 if ($id) {\n40 $article_transactions->updateExistingArticle(\n41 $user_id,\n42 $this->request->post\n43 );\n44 } else {\nAppendix J: Code After Controller Dependency Injection 217\n45 $article_transactions->submitNewArticle(\n46 $user_id,\n47 $this->request->post\n48 );\n49 }\n50\n51 $this->response->setView('articles.html.php');\n52 $this->response->setVars(array(\n53 'id' => $id,\n54 'failure' => $this->article_transactions->getFailure(),\n55 'input' => $this->article_transactions->getInput(),\n56 'action' => $this->request->server['PHP_SELF'],\n57 ));\n58\n59 return $this->response;\n60 }\n61 }\n62 ?>\n```"]