["```php\n**articles.php**\n1 <?php\n2 require \"includes/setup.php\";\n3\n4 $user_id = $user->getId();\n5\n6 $db = new Database($db_host, $db_user, $db_pass);\n7 $articles_gateway = new ArticlesGateway($db);\n8 $users_gateway = new UsersGateway($db);\n9 $article_transactions = new ArticleTransactions(\n10 $articles_gateway,\n11 $users_gateway\n12 );\n13\n14 $id = isset($_GET['id']) ? $_GET['id'] : 0;\n15 if ($id) {\n16 $article_transactions->updateExistingArticle($user_id, $_POST);\n17 } else {\n18 $article_transactions->submitNewArticle($user_id, $_POST);\n19 }\n20\n21 $failure = $article_transactions->getFailure();\n22 $input = $article_transactions->getInput();\n23 $action = $_SERVER['PHP_SELF'];\n24\n25 /** PRESENTATION */\n26\n27 $current_page = 'articles';\n28\n29 include \"header.php\";\n30\n31 if ($id) {\n32 $page_title = \"Edit An Article\";\n33 } else {\n34 $page_title = \"Submit An Article\";\n35 }\n36 ?>\n37\n38 <h1><?php echo $page_title ?></h1><?php\n39\n40 if ($failure) {\n41 $failure_text = implode(\"<br />\\n\", $failure);\n42 echo \"<h2>Failure</h2>\";\n43 echo \"<p>We could not save the article.<br />\";\n44 echo $failure_text. \"</p>\";\n45 } else {\n46 echo \"\n47 <h2>Success</h2>\n48 <p>We saved the article.</p>\n49 \";\n50 }\n51 ?>\n52\n53 <form method=\"POST\" action=\"<?php echo $action ?>\">\n54\n55 <input type=\"hidden\" name=\"id\" value=\"<?php echo $id ?>\" />\n56\n57 <h3>Title</h3>\n58 <input type=\"text\" name=\"title\" value=\"<?php\n59 echo $input['title']\n60 ?>\" size=\"100\">\n61\n62\n63 <h3>Article</h3>\n64 <textarea name=\"body\" cols=\"80\" rows=\"30\"><?php\n65 echo stripslashes($input['body'])\n66 ?></textarea>\n67\n68 <h3>Ratings</h3>\n69 <p>How many rated reviews do you want?</p>\n70 <select name='max_ratings'>\n71 <?php for ($i = 1; $i <= 10; $i ++) {\n72 echo \"<option value='$i' \";\n73 if ($input['max_ratings'] == $i) {\n74 echo 'selected=\"selected\"';\n75 }\n76 echo \">$i</option>\\n\";\n77 } ?>\n78 </select>\n79\n80 <p>How many credits will you give for each rating?</p>\n81 <input type='text' name='credits_per_rating' value='<?php\n82 echo $input['credits_per_rating'];\n83 ?>' size='5' />\n84\n85 <h3>Notes for Reviewers</h3>\n86 <input type=\"text\" name=\"notes\" value=\"<?php\n87 echo $input['notes']\n88 ?>\" size=\"100\">\n89 <label><input type=\"checkbox\" name=\"ready\" <?php\n90 echo $input['ready'] ? 'checked=\"checked\"' : '';\n91 ?> /> This article is ready to be rated.</label>\n92\n93 <p align=\"center\">\n94 <input type=\"submit\" value=\"Save\" name=\"submit\">\n95 </p>\n96\n97 </form>\n98\n99 <?php\n100 include \"footer.php\";\n101 ?>\n```"]