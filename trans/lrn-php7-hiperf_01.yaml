- en: Chapter 1. Setting Up the Environment
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章。设置环境
- en: PHP 7 has finally been released. For a long time, the PHP community was talking
    about it and has still not stopped. The main improvement in PHP 7 is its performance.
    For a long time, the PHP community faced performance issues in large-scale applications.
    Even some small applications with high traffic faced performance issues. Server
    resources were increased, but it did not help much because in the end the bottleneck
    was PHP itself. Different caching techniques were used, such as APC, and this
    helped a little. However, the community still needed a version of PHP that could
    boost the application's performance at its peak. And this is where PHPNG comes
    in.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: PHP 7终于发布了。很长一段时间以来，PHP社区一直在谈论它，而且仍未停止。PHP 7的主要改进是其性能。很长一段时间以来，PHP社区在大规模应用程序中面临性能问题。甚至一些高流量的小型应用程序也面临性能问题。服务器资源增加了，但并没有太大帮助，因为最终瓶颈是PHP本身。使用了不同的缓存技术，如APC，这有所帮助。然而，社区仍然需要一个能够在应用程序性能达到顶峰时提升性能的PHP版本。这就是PHPNG的用武之地。
- en: '**PHPNG** stands for **PHP next generation**. It is a completely separate branch
    and is mainly targeted for performance. Some people thought that PHPNG is **JIT**
    (**Just In Time**) compilation, but in reality, PHPNG is based on a refactored
    **Zend Engine**, which was highly optimized for performance. PHPNG is used as
    a base for PHP 7 development, and according to the official PHP wiki page, the
    PHPNG branch is now merged into the master branch.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**PHPNG**代表**PHP下一代**。它是一个完全独立的分支，主要针对性能。有些人认为PHPNG是**JIT**（**即时编译**），但实际上，PHPNG是基于经过高度优化的**Zend引擎**重构而成的。PHPNG被用作PHP
    7开发的基础，根据官方PHP维基页面，PHPNG分支现在已经合并到主分支中。'
- en: Before starting to build an application, the development environment should
    be finalized and configured. In this chapter, we will discuss setting up the development
    environment on different systems, such as Windows and different flavors of Linux.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始构建应用程序之前，应该完成并配置好开发环境。在本章中，我们将讨论在不同系统上设置开发环境，如Windows和不同版本的Linux。
- en: 'We will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将涵盖以下主题：
- en: Setting up Windows
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置Windows
- en: Setting up Ubuntu or Debian
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置Ubuntu或Debian
- en: Setting up CentOS
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置CentOS
- en: Setting up Vagrant
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置Vagrant
- en: All other environments can be skipped, and we can set up the environment that
    we will use.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 其他所有环境都可以跳过，我们可以设置我们将使用的环境。
- en: Setting up Windows
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置Windows
- en: There are many tools available that have Apache, PHP, and MySQL bundled for
    Windows, provide easy installation, and are very easy to use. Most of these tools
    already provide support for PHP 7 with Apache, such as through XAMPP, WAMPP, and
    EasyPHP. EasyPHP is the only one that also provides support for **NGINX** and
    provides easy steps to changes webserver from NGINX to Apache or Apache to Nginx.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多可用的工具，它们在Windows上捆绑了Apache、PHP和MySQL，提供了简单的安装，并且非常易于使用。这些工具中的大多数已经提供了对PHP
    7与Apache的支持，例如XAMPP、WAMPP和EasyPHP。EasyPHP是唯一一个还提供对**NGINX**的支持，并提供了从NGINX切换到Apache或从Apache切换到Nginx的简单步骤。
- en: Note
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: XAMPP is also available for Linux and Mac OS X. However, WAMP and EasyPHP are
    only available for Windows. Any of these three can be used for this book, but
    we recommend EasyPHP as it supports NGINX, and for this book, we mostly use NGINX.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: XAMPP也适用于Linux和Mac OS X。但是，WAMP和EasyPHP仅适用于Windows。这三种工具中的任何一种都可以用于本书，但我们建议使用EasyPHP，因为它支持NGINX，并且在本书中，我们主要使用NGINX。
- en: Any of the three tools can be used, but we require more control over every element
    of our web server tools, so we will also install NGINX, PHP 7, and MySQL individually
    and then connect them together.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用这三种工具中的任何一种，但我们需要更多地控制我们的Web服务器工具的每个元素，因此我们将单独安装NGINX、PHP 7和MySQL，然后将它们连接在一起。
- en: Note
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: NGINX Windows binaries can be downloaded from [http://nginx.org/en/download.html](http://nginx.org/en/download.html).
    We recommend using a stable version, though there is no problem with using a mainline
    version. PHP Windows binaries can be downloaded from [http://windows.php.net/download/](http://windows.php.net/download/).
    Download either 32-bit or 64-bit binaries of the *non-thread safe* version according
    to your system.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 可以从[http://nginx.org/en/download.html](http://nginx.org/en/download.html)下载NGINX
    Windows二进制文件。我们建议使用稳定版本，尽管使用主线版本也没有问题。可以从[http://windows.php.net/download/](http://windows.php.net/download/)下载PHP
    Windows二进制文件。根据您的系统下载32位或64位的*非线程安全*版本。
- en: 'Perform the following steps:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤：
- en: Download NGINX and PHP Windows binaries mentioned in the information box. Copy
    NGINX to a suitable directory. For example, we have a completely separate D drive
    for development purposes. Copy NGINX to this development drive or any other directory.
    Now, copy PHP either to the NGINX directory or to any other secure folder location.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载信息框中提到的NGINX和PHP Windows二进制文件。将NGINX复制到合适的目录。例如，我们有一个完全独立的D盘用于开发目的。将NGINX复制到这个开发驱动器或任何其他目录。现在，将PHP复制到NGINX目录或任何其他安全文件夹位置。
- en: In the PHP directory, there will be two `.ini` files, `php.ini-development`
    and `php.ini-production`. Rename either one of them to `php.ini`. PHP will be
    using this configuration file.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在PHP目录中，将有两个`.ini`文件，`php.ini-development`和`php.ini-production`。将其中一个重命名为`php.ini`。PHP将使用这个配置文件。
- en: 'Hold the *Shift* key and right click in the PHP directory to open the command-line
    window. The command-line window will be opened in the same location path. Issue
    the following command to start PHP:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按住*Shift*键并在PHP目录中右键单击以打开命令行窗口。命令行窗口将在相同的位置路径中打开。发出以下命令启动PHP：
- en: '[PRE0]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The `–b` option starts PHP and binds to the path for external **FastCGI** servers.
    The preceding command binds PHP to loop back the `127.0.0.1` IP on port `9000`.
    Now, PHP is accessible on this path.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '`-b`选项启动PHP并绑定到外部**FastCGI**服务器的路径。上述命令将PHP绑定到回环`127.0.0.1`IP的端口`9000`。现在，PHP可以在这个路径上访问。'
- en: 'To configure NGINX, open the `nginx_folder/conf/nginx.conf` file. The first
    thing to do is to add root and index to the server block, as follows:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要配置NGINX，打开`nginx_folder/conf/nginx.conf`文件。首先要做的是在服务器块中添加root和index，如下所示：
- en: '[PRE1]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Tip
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Downloading the example code**'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**下载示例代码**'
- en: You can download the example code files for this book from your account at http://www.packtpub.com.
    If you purchased this book elsewhere, you can visit http://www.packtpub.com/support
    and register to have the files e-mailed directly to you.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从http://www.packtpub.com的帐户中下载本书的示例代码文件。如果您在其他地方购买了这本书，可以访问http://www.packtpub.com/support并注册，以便将文件直接发送到您的电子邮件。
- en: 'You can download the code files by following these steps:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以按照以下步骤下载代码文件：
- en: Log in or register to our website using your e-mail address and password.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用您的电子邮件地址和密码登录或注册到我们的网站。
- en: Hover the mouse pointer on the SUPPORT tab at the top.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将鼠标指针悬停在顶部的SUPPORT选项卡上。
- en: Click on Code Downloads & Errata.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单击代码下载和勘误。
- en: Enter the name of the book in the Search box.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在搜索框中输入书名。
- en: Select the book for which you're looking to download the code files.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择您要下载代码文件的书。
- en: Choose from the drop-down menu where you purchased this book from.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择您购买本书的地方。
- en: Click on Code Download.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单击代码下载。
- en: 'Once the file is downloaded, please make sure that you unzip or extract the
    folder using the latest version of:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 下载文件后，请确保使用最新版本的以下软件解压或提取文件夹：
- en: WinRAR / 7-Zip for Windows
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows的WinRAR / 7-Zip
- en: Zipeg / iZip / UnRarX for Mac
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Mac的Zipeg / iZip / UnRarX
- en: 7-Zip / PeaZip for Linux
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux的7-Zip / PeaZip
- en: 'Now, we need to configure NGINX to use PHP as FastCGI on the path mentioned
    before on which it is started. In the `nginx.conf` file, uncomment the following
    location block for PHP:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要配置NGINX以在启动时使用PHP作为FastCGI的路径。在`nginx.conf`文件中，取消注释以下位置块以用于PHP：
- en: '[PRE2]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Note the `fastcgi_param` option. The highlighted `complete_path_webroot_folder`
    path should be the absolute path to the HTML directory inside the `nginx` folder.
    Let's say that your NGINX is placed at the `D:\nginx` path; then, the absolute
    path to the `HTML` folder will be `D:\nginx\html`. However, for the preceding
    `fastcgi_param` option, `\` should be replaced by `/`.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 注意`fastcgi_param`选项。突出显示的`complete_path_webroot_folder`路径应该是`nginx`文件夹内HTML目录的绝对路径。假设您的NGINX放置在`D:\nginx`路径，那么`HTML`文件夹的绝对路径将是`D:\nginx\html`。但是，对于前面的`fastcgi_param`选项，`\`应该替换为`/`。
- en: 'Now, restart NGINX by issuing the following command in the root of the NGINX
    folder:'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在NGINX文件夹的根目录中发出以下命令重新启动NGINX：
- en: '[PRE3]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: After NGINX is restarted, open your browser and enter the IP or hostname of
    your Windows server or machine, and we will see the NGINX welcome message.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在重新启动NGINX后，打开浏览器，输入Windows服务器或机器的IP或主机名，我们将看到NGINX的欢迎消息。
- en: 'Now, to verify the PHP installation and its working with NGINX, create an `info.php`
    file in webroot and enter the following code in it:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，要验证PHP安装并与NGINX一起工作，请在webroot中创建一个`info.php`文件，并输入以下代码：
- en: '[PRE4]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Now, in the browser, access [your_ip/info.php](http://your_ip/info.php), and
    we will be presented with a page full of PHP and server information. Congratulations!
    We configured NGINX and PHP to work perfectly together.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在浏览器中访问[your_ip/info.php](http://your_ip/info.php)，我们将看到一个充满PHP和服务器信息的页面。恭喜！我们已经成功配置了NGINX和PHP，使它们完美地配合工作。
- en: Note
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: On Windows and Mac OS X, we recommend that you use a virtual machine installed
    with all the tools on a Linux flavor to get the best performance out of the server.
    It is easy to manage everything in Linux. There are vagrant boxes available that
    have everything ready to use. Also, a custom virtual machine configuration with
    all the tools, including NGINX, Apache, PHP 7, Ubuntu, Debian, or CentOS, and
    other great ones, can be made at [https://puphpet.com](https://puphpet.com), which
    is an easy-to-use GUI. Another nice tool is Laravel Homestead, which is a **Vagrant**
    box with great tools.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows和Mac OS X上，我们建议您使用安装有Linux版本的所有工具的虚拟机，以获得服务器的最佳性能。在Linux中管理一切很容易。有现成的vagrant
    boxes可供使用。另外，可以在[https://puphpet.com](https://puphpet.com)上制作包括NGINX、Apache、PHP
    7、Ubuntu、Debian或CentOS等工具的自定义虚拟机配置，这是一个易于使用的GUI。另一个不错的工具是Laravel Homestead，这是一个带有很棒工具的**Vagrant**
    box。
- en: Setting up Debian or Ubuntu
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置Debian或Ubuntu
- en: Ubuntu is derived from Debian, so the process is the same for both Ubuntu and
    Debian. We will use Debian 8 Jessie and Ubuntu 14.04 Server LTS. The same process
    can be applied to desktop versions for both.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: Ubuntu是从Debian派生的，因此对于Ubuntu和Debian，过程是相同的。我们将使用Debian 8 Jessie和Ubuntu 14.04
    Server LTS。相同的过程也适用于两者的桌面版本。
- en: First, add the repositories for both Debian and Ubuntu.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，为Debian和Ubuntu添加存储库。
- en: Debian
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Debian
- en: 'As of the time we''re writing this book, Debian does not provide an official
    repository for PHP 7\. So, for Debian, we will use `dotdeb` repositories to install
    NGINX and PHP 7\. Perform the following steps:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 截至我们撰写本书的时间，Debian没有为PHP 7提供官方存储库。因此，对于Debian，我们将使用`dotdeb`存储库来安装NGINX和PHP 7。执行以下步骤：
- en: 'Open the `/etc/apt/sources.list` file and add the following two lines at the
    end of the file:'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`/etc/apt/sources.list`文件，并在文件末尾添加以下两行：
- en: '[PRE5]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Now, execute the following commands in the terminal:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在终端中执行以下命令：
- en: '[PRE6]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The first two commands will add `dotdeb` repo to Debian and the last command
    will refresh the cache for sources.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 前两个命令将向Debian添加`dotdeb`存储库，最后一个命令将刷新源的缓存。
- en: Ubuntu
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Ubuntu
- en: 'As of the time of writing this book, Ubuntu also does not provide PHP 7 in
    their official repos, so we will use a third-party repo for the PHP 7 installation.
    Perform the following steps:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 截至撰写本书的时间，Ubuntu也没有在官方存储库中提供PHP 7，因此我们将使用第三方存储库进行PHP 7的安装。执行以下步骤：
- en: 'Run the following commands in the terminal:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在终端中运行以下命令：
- en: '[PRE7]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Now, the repositories are added. Let's install NGINX and PHP 7.
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，存储库已添加。让我们安装NGINX和PHP 7。
- en: Note
  id: totrans-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The rest of the process is mostly the same for both Debian and Ubuntu, so we
    wont list them separately, as we did for the adding repositories section.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 其余的过程对于Debian和Ubuntu大部分是相同的，所以我们不会单独列出它们，就像我们为添加存储库部分所做的那样。
- en: 'To install NGINX, run the following command in the terminal (Debian and Ubuntu):'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要安装NGINX，请在终端中运行以下命令（Debian和Ubuntu）：
- en: '[PRE8]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: After the installation is successful, it can be verified by entering the hostname
    and IP of the Debian or Ubuntu server. If we see something similar to the following
    screenshot, then our installation is successful:![Ubuntu](graphics/B05225_01_01.jpg)
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装成功后，可以通过输入Debian或Ubuntu服务器的主机名和IP来验证。如果看到类似下面的屏幕截图，那么我们的安装是成功的：![Ubuntu](graphics/B05225_01_01.jpg)
- en: 'The following is a list of three useful NGINX commands:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是三个有用的NGINX命令列表：
- en: '`service nginx start`: This starts the NGINX server'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`service nginx start`：这将启动NGINX服务器'
- en: '`service nginx restart`: This restarts the NGINX server'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`service nginx restart`：这将重新启动NGINX服务器'
- en: '`service nginx stop`: This stops the NGINX server'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`service nginx stop`：这将停止NGINX服务器'
- en: 'Now, it''s time to install PHP 7 by issuing the following command:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，是时候通过发出以下命令来安装PHP 7了：
- en: '[PRE9]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'This will install PHP 7 along with the other modules mentioned. Also, we installed
    PHP Cli for the command-line purpose. To verify whether PHP 7 is properly installed,
    issue the following command in the terminal:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这将安装PHP 7以及其他提到的模块。此外，我们还为命令行目的安装了PHP Cli。要验证PHP 7是否已正确安装，请在终端中发出以下命令：
- en: '[PRE10]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: If it displays the PHP version along with some other details, as shown in the
    following screenshot, then PHP is properly installed:![Ubuntu](graphics/B05225_01_02.jpg)
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果显示PHP版本以及其他一些细节，如下面的屏幕截图所示，那么PHP已经正确安装：![Ubuntu](graphics/B05225_01_02.jpg)
- en: 'Now, we need to configure NGINX to work with PHP 7\. First, copy the NGINX
    default config file `/etc/nginx/sites-available/default` to `/etc/nginx/sites-available/www.packt.com.conf`
    using the following command in the terminal:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要配置NGINX以与PHP 7一起工作。首先，通过在终端中使用以下命令将NGINX默认配置文件`/etc/nginx/sites-available/default`复制到`/etc/nginx/sites-available/www.packt.com.conf`：
- en: '[PRE11]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: First, we copied the default configuration file, created another virtual host
    configuration file, `www.packt.com.conf`, and then created a symbolic link file
    to this virtual host file in the sites-enabled folder.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们复制了默认配置文件，创建了另一个虚拟主机配置文件`www.packt.com.conf`，然后在sites-enabled文件夹中为这个虚拟主机文件创建了一个符号链接文件。
- en: Note
  id: totrans-83
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: It is good practice to create a configuration file for each virtual host by
    the same name as of the domain so that it can easily be recognized by any other
    person.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 为每个虚拟主机创建一个与域名相同的配置文件是一个很好的做法，这样可以很容易地被其他人识别。
- en: 'Now, open the `/etc/nginx/sites-available/www.packt.com.conf` file and add
    or edit the highlighted code, as shown here:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，打开`/etc/nginx/sites-available/www.packt.com.conf`文件，并添加或编辑高亮显示的代码，如下所示：
- en: '[PRE12]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The preceding configuration is not a complete configuration file. We copied
    only those configuration options that are important and that we may want to change.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 上述配置不是一个完整的配置文件。我们只复制了那些重要的配置选项，我们可能想要更改的选项。
- en: In the preceding code, our webroot path is `/var/www/html`, where our PHP files
    and other application files will be placed. In the index config option, add `index.php`
    so that if no file is provided in the URL, NGINX can look for and parse `index.php`.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述代码中，我们的webroot路径是`/var/www/html`，我们的PHP文件和其他应用程序文件将放在这里。在索引配置选项中，添加`index.php`，这样如果URL中没有提供文件，NGINX就可以查找并解析`index.php`。
- en: We added a location block for PHP that includes a `fastcgi_pass` option, which
    has a path to the PHP7 FPM socket. Here, our PHP runs on a Unix socket, which
    is faster than that of TCP/IP.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们添加了一个用于PHP的位置块，其中包括一个`fastcgi_pass`选项，该选项具有指向PHP7 FPM套接字的路径。在这里，我们的PHP运行在Unix套接字上，比TCP/IP更快。
- en: 'After making these changes, restart NGINX. Now, to test whether PHP and NGINX
    are properly configured, create an `info.php` file at the root of the `webroot`
    folder and place the following code in it:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在进行这些更改后，重新启动NGINX。现在，为了测试PHP和NGINX是否正确配置，创建一个`info.php`文件放在`webroot`文件夹的根目录，并在其中放入以下代码：
- en: '[PRE13]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Now, in the browser, type `server_ip/info.php`, and if you see a PHP configuration
    page, then congratulations! PHP and NGINX are both properly configured.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在浏览器中输入`server_ip/info.php`，如果看到一个PHP配置页面，那么恭喜！PHP和NGINX都已正确配置。
- en: Note
  id: totrans-93
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If PHP and NGINX run on the same system, then PHP listens to the loopback IP
    at port `9000`. The port can be changed to any other port. In case, we want to
    run PHP on the TCP/IP port, then in `fastcgi_pass`, we will enter `127.0.0.1:9000`.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果PHP和NGINX在同一系统上运行，那么PHP会监听端口`9000`的环回IP。端口可以更改为任何其他端口。如果我们想要在TCP/IP端口上运行PHP，那么在`fastcgi_pass`中，我们将输入`127.0.0.1:9000`。
- en: 'Now, let''s install **Percona Server**. Percona Server is a fork of MySQL and
    is optimized for high performance. We will read more about Percona Server in [Chapter
    3](ch03.html "Chapter 3. Improving PHP 7 Application Performance"), *Increasing
    PHP 7 Application Performance*. Now, let''s install Percona Server on Debian/Ubuntu
    via the following steps:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们安装**Percona Server**。Percona Server是MySQL的一个分支，经过优化以获得更高的性能。我们将在[第3章](ch03.html
    "第3章。提高PHP 7应用程序性能")中更多地了解Percona Server，*提高PHP 7应用程序性能*。现在，让我们通过以下步骤在Debian/Ubuntu上安装Percona
    Server：
- en: 'First, let''s add the Percona Server repository to our system by running the
    following command in the terminal:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们通过在终端中运行以下命令将Percona Server仓库添加到我们的系统中：
- en: '[PRE14]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The first command will download the repo packages from the Percona repo. The
    second command will install the downloaded packages and will create a `percona-release.list`
    file at `/etc/apt/sources.list.d/percona-release.list`.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个命令将从Percona仓库下载软件包。第二个命令将安装已下载的软件包，并在`/etc/apt/sources.list.d/percona-release.list`创建一个`percona-release.list`文件。
- en: 'Now, install Percona Server by executing the following command in the terminal:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，通过在终端中执行以下命令来安装Percona Server：
- en: '[PRE15]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now, issue the following command to install Percona Server:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，通过发出以下命令来安装Percona Server：
- en: '[PRE16]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The installation process will start. It will take a while to download it.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 安装过程将开始。下载需要一段时间。
- en: Note
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For the purpose of this book, we will install Percona Server 5.5\. Percona Server
    5.6 is also available, which can be installed without any issues.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 为了本书的目的，我们将安装Percona Server 5.5。也可以安装Percona Server 5.6，而且不会出现任何问题。
- en: 'During the installation, the password for the `root` user will be asked, as
    shown in the following screenshot:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装过程中，将要求输入`root`用户的密码，如下图所示：
- en: '![Ubuntu](graphics/B05225_01_03.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![Ubuntu](graphics/B05225_01_03.jpg)'
- en: It is optional but recommended to enter the password. After entering the password,
    re-enter the password on the next screen. The installation process will continue.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 输入密码是可选的但建议的。输入密码后，在下一个屏幕上重新输入密码。安装过程将继续。
- en: 'After the installation is complete, the Percona Server installation can be
    verified by using the following command:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装完成后，可以使用以下命令验证Percona Server的安装：
- en: '[PRE17]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: It will display the version of Percona Server. As mentioned before, Percona
    Server is a fork of MySQL, so all the same MySQL commands, queries, and settings
    can be used.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 它将显示Percona Server的版本。如前所述，Percona Server是MySQL的一个分支，因此可以使用相同的MySQL命令、查询和设置。
- en: Setting up CentOS
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置CentOS
- en: CentOS is a fork of **Red Hat Enterprise Linux** (**RHEL**) and stands for **Community
    Enterprise Operating System**. It is a widely used OS on servers specially used
    by hosting companies to provide shared hosting.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: CentOS是**Red Hat Enterprise Linux**（**RHEL**）的一个分支，代表**Community Enterprise
    Operating System**。它是服务器上广泛使用的操作系统，特别是由托管公司提供共享托管服务。
- en: 'Let''s start by configuring CentOS for our development environment. Perform
    the following steps:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先为我们的开发环境配置CentOS。执行以下步骤：
- en: Installing NGINX
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装NGINX
- en: 'First, we need to add NGINX RPM to our CentOS installation because CentOS does
    not provide any default repository for NGINX. Issue the following command in your
    terminal:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要将NGINX RPM添加到我们的CentOS安装中，因为CentOS没有提供任何默认的NGINX仓库。在终端中输入以下命令：
- en: '[PRE18]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: This will add the NGINX repo to CentOS.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 这将向CentOS添加NGINX仓库。
- en: 'Now, issue the following command to see which versions of NGINX are available
    to install:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，输入以下命令以查看可供安装的NGINX版本：
- en: '[PRE19]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This will show you the latest stable releases. In our case, it displays NGINX
    1.8.0 and NGINX 1.8.1.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示最新的稳定版本。在我们的情况下，它显示NGINX 1.8.0和NGINX 1.8.1。
- en: 'Now, let''s install NGINX using the following command:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用以下命令安装NGINX：
- en: '[PRE20]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This will install NGINX.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这将安装NGINX。
- en: 'On CentOS, NGINX won''t start automatically after installation or restarting.
    So, first, we will enable NGINX to autostart after a system restarts using the
    following command:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在CentOS上，NGINX在安装或重新启动后不会自动启动。因此，首先，我们将使用以下命令使NGINX在系统重新启动后自动启动：
- en: '[PRE21]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Now, let''s start NGINX by issuing the following command:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们通过输入以下命令来启动NGINX：
- en: '[PRE22]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Then, open your browser and enter the IP of the CentOS server or host name.
    If you see the same welcome screen as we saw in the figure earlier in the chapter
    for Debian, then NGINX is installed successfully.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，打开浏览器，输入CentOS服务器的IP或主机名。如果您看到与我们在Debian章节中看到的欢迎屏幕相同的屏幕，则NGINX已成功安装。
- en: 'To check which version of NGINX is installed, issue the following command in
    the terminal:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查安装了哪个版本的NGINX，请在终端中输入以下命令：
- en: '[PRE23]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: On our server, the NGINX version installed is 1.8.1.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的服务器上，安装的NGINX版本是1.8.1。
- en: Now, our web server is ready.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们的Web服务器已准备就绪。
- en: Installing PHP 7
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装PHP 7
- en: 'The next step is to install PHP 7 FPM and configure both NGINX and PHP 7 to
    work together. As of the time of writing this book, PHP 7 is not packaged in official
    CentOS repositories. So, we have two choices to install PHP 7: either we build
    it from source, or we use third-party repositories. Building from source is a
    little bit difficult, so let''s go the easy way and use third-party repositories.'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是安装PHP 7 FPM并配置NGINX和PHP 7一起工作。在撰写本书时，PHP 7没有打包在官方的CentOS仓库中。因此，我们有两种选择来安装PHP
    7：要么从源代码构建，要么使用第三方仓库。从源代码构建有点困难，所以让我们选择简单的方式，使用第三方仓库。
- en: Note
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For this book, we will use webtatic repos for the PHP 7 installation as they
    provide quick updates for the new versions. There are some more repositories,
    and it is just the reader's choice to use any repository as long as it works.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本书，我们将使用webtatic仓库来安装PHP 7，因为它们为新版本提供快速更新。还有一些其他仓库，只要它能正常工作，读者可以自行选择使用任何仓库。
- en: 'Now, let''s add a webtatic repository to our CentOS repo by issuing the following
    command:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们通过输入以下命令向我们的CentOS仓库添加webtatic仓库：
- en: '[PRE24]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'After the repos are added successfully, issue the following command to see
    which version is available for installation:'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 成功添加仓库后，输入以下命令以查看可供安装的版本：
- en: '[PRE25]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: In our case, PHP 7.0.3 is available to install.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的情况下，可以安装PHP 7.0.3。
- en: 'Now, issue the following command to install PHP 7 along with some modules that
    may be required:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，输入以下命令以安装PHP 7以及可能需要的一些模块：
- en: '[PRE26]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'This will install core PHP 7 and some modules available for PHP 7\. If any
    other module is required, it can be installed easily; however, first, search to
    check whether it is available or not. Issue the following command in the terminal
    to see all the available modules for PHP 7:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将安装核心PHP 7和一些可用于PHP 7的模块。如果需要其他模块，可以轻松安装；但是首先搜索以检查其是否可用。在终端中输入以下命令以查看所有可用的PHP
    7模块：
- en: '[PRE27]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: We will see a long list of all the available modules for PHP 7.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 将显示所有可用的PHP 7模块的长列表。
- en: 'Now, let''s say that we want to install the PHP 7 gd module; issue the following
    command:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，假设我们要安装PHP 7 gd模块；输入以下命令：
- en: '[PRE28]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This will install the gd module. Multiple modules can be installed using the
    same command and separating each module by a space, as we did in the initial installation
    of PHP.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这将安装gd模块。可以使用相同的命令安装多个模块，并通过空格分隔每个模块，就像我们在最初安装PHP时所做的那样。
- en: 'Now, to check which version of PHP is installed, issue the following command:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，要检查安装了哪个版本的PHP，请输入以下命令：
- en: '[PRE29]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: In our case, PHP 7.0.3 is installed.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的情况下，安装了PHP 7.0.3。
- en: 'To start, stop, and restart PHP, issue the following commands in the terminal:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启动、停止和重新启动PHP，请在终端中输入以下命令：
- en: '[PRE30]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Now, let''s configure NGINX to use PHP FPM. Open the default NGINX virtual
    host file located at `/etc/Nginx/conf.d/default.conf` using either `vi`, `nano`,
    or any other editor of your choice. Now, make sure that two options are set in
    the server block, as follows:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们配置NGINX以使用PHP FPM。使用`vi`、`nano`或您选择的任何其他编辑器打开位于`/etc/Nginx/conf.d/default.conf`的默认NGINX虚拟主机文件。现在，请确保服务器块中设置了两个选项，如下所示：
- en: '[PRE31]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: The `root` option indicates the web document root where our website source code
    files will be placed. Index indicates the default files that will be loaded along
    with extensions. If any of these files are found, they will be executed by default,
    regardless of any file mentioned in the URLs.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '`root`选项表示我们的网站源代码文件将放置的Web文档根目录。Index表示将与扩展名一起加载的默认文件。如果找到任何这些文件，默认情况下将执行它们，而不管URL中提到的任何文件。'
- en: 'The next configuration in NGINX is a location block for PHP. The following
    is the configuration for PHP:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: NGINX中的下一个配置是用于PHP的位置块。以下是PHP的配置：
- en: '[PRE32]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The preceding block is the most important configuration as it enables NGINX
    to communicate with PHP. The line `fastcgi_pass 127.0.0.1:9000` tells NGINX that
    PHP FPM can be accessed on the `127.0.0.1` loopback IP on port `9000`. The rest
    of the details are the same as those we discussed for Debian and Ubuntu.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 上述块是最重要的配置，因为它使NGINX能够与PHP通信。行`fastcgi_pass 127.0.0.1:9000`告诉NGINX，PHP FPM可以在端口`9000`上的`127.0.0.1`环回IP上访问。其余细节与我们讨论Debian和Ubuntu的内容相同。
- en: 'Now, to test our installation, we will create a file named `info.php` with
    the following contents:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，为了测试我们的安装，我们将创建一个名为`info.php`的文件，其中包含以下内容：
- en: '[PRE33]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: After saving the file, type `http://server_ip/info.php` or `http://hostname/info.php`,
    and we will get a page with complete information about PHP. If you see this page,
    congratulations! PHP runs alongside NGINX.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 保存文件后，输入`http://server_ip/info.php`或`http://hostname/info.php`，我们将得到一个包含有关PHP的完整信息的页面。如果您看到此页面，恭喜！PHP与NGINX一起运行。
- en: Installing Percona Server
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装Percona Server
- en: 'Now, we will install Percona Server on CentOS. The installation process is
    the same, except that it has a separate repository. To add the Percona Server
    repo to CentOS, execute the following command in the terminal:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将在CentOS上安装Percona Server。安装过程相同，只是它有一个单独的存储库。要将Percona Server存储库添加到CentOS，请在终端中执行以下命令：
- en: '[PRE34]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: After the repo installation is completed, a message will be displayed stating
    the completion of the installation.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 存储库安装完成后，将显示一条消息，指示安装完成。
- en: 'Now, to test the repo, issue the following command, and it will list all the
    available Percona packages:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，为了测试存储库，发出以下命令，它将列出所有可用的Percona软件包：
- en: '[PRE35]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'To install Percona Server 5.5, issue the following command in the terminal:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要安装Percona Server 5.5，请在终端中发出以下命令：
- en: '[PRE36]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: The installation process will start. The rest of the process is the same as
    for Debian/Ubuntu.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 安装过程将开始。其余的过程与Debian/Ubuntu相同。
- en: After the installation is completed, we will see a completion message.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装完成后，将看到完成消息。
- en: Setting up Vagrant
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置Vagrant
- en: Vagrant is a tool used by developers for development environments. Vagrant provides
    an easy command-line interface to set up virtual machines with all the tools required.
    Vagrant uses boxes called Vagrant Boxes that can have a Linux operating system
    and other tools according to this box. Vagrant supports both Oracle VM VirtualBox
    and VMware. For the purpose of this book, we will use VirtualBox, which we assume
    is installed on your machine as well.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: Vagrant是开发人员用于开发环境的工具。Vagrant提供了一个简单的命令行界面，用于设置带有所有所需工具的虚拟机。Vagrant使用称为Vagrant
    Boxes的框，可以具有Linux操作系统和根据此框的其他工具。Vagrant支持Oracle VM VirtualBox和VMware。为了本书的目的，我们将使用VirtualBox，我们假设它也安装在您的机器上。
- en: Vagrant has several boxes for PHP 7, including Laravel Homestead and Rasmus
    PHP7dev. So, let's get started by configuring the Rasmus PHP7dev box on Windows
    and Mac OS X.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: Vagrant有几个用于PHP 7的框，包括Laravel Homestead和Rasmus PHP7dev。因此，让我们开始配置Windows和Mac
    OS X上的Rasmus PHP7dev框。
- en: Note
  id: totrans-178
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: We assume that both VirutalBox and Vagrant are installed on our machine. VirtualBox
    can be downloaded from [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads),
    and Vagrant can be downloaded from [https://www.vagrantup.com/downloads.html](https://www.vagrantup.com/downloads.html)
    for different platforms. Details about Rasmus PHP7dev VagrantBox can be found
    at [https://github.com/rlerdorf/php7dev](https://github.com/rlerdorf/php7dev).
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们假设我们的机器上都安装了VirutalBox和Vagrant。可以从[https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)下载VirtualBox，可以从[https://www.vagrantup.com/downloads.html](https://www.vagrantup.com/downloads.html)下载Vagrant，适用于不同的平台。有关Rasmus
    PHP7dev VagrantBox的详细信息，请访问[https://github.com/rlerdorf/php7dev](https://github.com/rlerdorf/php7dev)。
- en: 'Perform the following steps:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤：
- en: Make a directory in one of the drives. For example, we made a `php7` directory
    in our `D` drive. Then, open the command line in this specific folder directly
    by holding the *Shift* key, right-clicking, and then selecting **Open command
    window here**.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在其中一个驱动器中创建一个目录。例如，我们在`D`驱动器中创建了一个`php7`目录。然后，通过按住*Shift*键，右键单击，然后选择**在此处打开命令窗口**，直接在此特定文件夹中打开命令行。
- en: 'Now, issue the following command in the command window:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在命令窗口中输入以下命令：
- en: '[PRE37]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'It will start downloading the Vagrant box, as shown in the following screenshot:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 它将开始下载Vagrant框，如下截图所示：
- en: '![Setting up Vagrant](graphics/B05225_01_04.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![设置Vagrant](graphics/B05225_01_04.jpg)'
- en: 'Now, when the download is completed, we need to initialize it so that the box
    is configured and added to VirtualBox for us. Issue the following command in the
    command window:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，当下载完成时，我们需要初始化它，以便为我们配置并将该框添加到VirtualBox中。在命令窗口中输入以下命令：
- en: '[PRE38]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'This will start adding the box to VirtualBox and configuring it. When the process
    is completed, it will display a message, as in the following screenshot:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 这将开始将框添加到VirtualBox并对其进行配置。完成该过程后，将显示一条消息，如下截图所示：
- en: '![Setting up Vagrant](graphics/B05225_01_05.jpg)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![设置Vagrant](graphics/B05225_01_05.jpg)'
- en: 'Now, issue the following command, which will completely set up the Vagrant
    box and start it up and running:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，输入以下命令，这将完全设置Vagrant框并启动它：
- en: '[PRE39]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: This process will take a little bit of time. When it is completed, your box
    is ready and running and can be used.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程会花一点时间。当完成后，你的框已经准备好并且可以使用了。
- en: 'Now, the first thing to do after it is up is to update everything. This box
    uses Ubuntu, so open the command window in the same `php7dev` directory and issue
    the following command:'
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，启动后的第一件事是更新所有内容。这个框使用Ubuntu，所以在相同的`php7dev`目录中打开命令窗口，并输入以下命令：
- en: '[PRE40]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: It will connect us with the virtual machines through SSH.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 它将通过SSH将我们连接到虚拟机。
- en: Note
  id: totrans-196
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: In Windows, if SSH in not installed or not configured in the `PATH` variable,
    PuTTY can be used. It can be downloaded from [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html).
    For PuTTY, the host will be `127.0.0.1`, and the port will be `2222`. `Vagrant`
    is both the username and password for SSH.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows中，如果SSH未安装或未在`PATH`变量中配置，可以使用PuTTY。可以从[http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)下载。对于PuTTY，主机将是`127.0.0.1`，端口将是`2222`。`Vagrant`是SSH的用户名和密码。
- en: 'When we are logged in to the box OS, issue the following commands to update
    the system:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们登录到框的操作系统时，输入以下命令来更新系统：
- en: '[PRE41]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: This will update the core system, NGINX, MySQL, PHP 7, and other installed tools
    if new versions are available.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 这将更新核心系统、NGINX、MySQL、PHP 7和其他安装的工具，如果有新版本的话。
- en: 'The box is now ready to use for development purposes. The box can be accessed
    in the browser by typing its IP address in the browser window. To find the IP
    address of the box, issue the following command in the SSH-connected command window:'
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，框已经准备好用于开发目的。可以通过在浏览器窗口中输入其IP地址来访问框。要找到框的IP地址，在SSH连接的命令窗口中输入以下命令：
- en: '[PRE42]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: This will display some details. Find out the IPv4 details there and take the
    IP of the box.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示一些细节。在那里找到IPv4的细节并取得框的IP。
- en: Summary
  id: totrans-204
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we configured different environments for the purpose of development.
    We installed NGINX and PHP 7 on the windows machine. We also configured Debian/Ubuntu
    and installed NGINX, PHP, and Percona Server 5.5\. Then, we configured CentOS
    and installed NGINX, PHP, and Percona Server 5.5\. Lastly, we discussed how to
    configure Vagrant Box on a Windows machine.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们为开发目的配置了不同的环境。我们在Windows机器上安装了NGINX和PHP 7。我们还配置了Debian/Ubuntu并安装了NGINX、PHP和Percona
    Server 5.5。然后，我们配置了CentOS并安装了NGINX、PHP和Percona Server 5.5。最后，我们讨论了如何在Windows机器上配置Vagrant
    Box。
- en: In the next chapter, we will study new features in PHP 7, such as type hints,
    namespace groupings and declarations, the Spaceship operator, and other features.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习PHP 7的新功能，比如类型提示、命名空间分组和声明、太空船操作符等其他功能。
