["```php\n<?php\n2 include(\"common/db_include.php\");\n3 include(\"common/functions.inc\");\n4 include(\"theme/leftnav.php\");\n5 include(\"theme/header.php\");\n6\n7 define(\"SEARCHNUM\", 10);\n8\n9 function letter_links()\n10 {\n11 global $p, $letter;\n12 $lettersArray = array(\n13 '0-9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I',\n14 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S',\n15 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'\n16 );\n17 foreach ($lettersArray as $let) {\n18 if ($letter == $let)\n19 echo $let.' ';\n20 else\n21 echo '<a class=\"letters\" '\n22 . 'href=\"letter.php?p='\n23 . $p\n24 . '&letter='\n25 . $let\n26 . '\">'\n27 . $let\n28 . '</a> ';\n29 }\n30 }\n31\n32 $page = ($page) ? $page : 0;\n33\n34 if (!empty($p) && $p!=\"all\" && $p!=\"none\") {\n35 $where = \"`foo` LIKE '%$p%'\";\n36 } else {\n37 $where = \"1\";\n38 }\n39\n40 if ($p==\"hand\") {\n41 $where = \"`foo` LIKE '%type1%'\"\n42 . \" OR `foo` LIKE '%type2%'\"\n43 . \" OR `foo` LIKE '%type3%'\";\n44 }\n45\n46 $where .= \" AND `bar`='1'\";\n47 if ($s) {\n48 $s = str_replace(\" \", \"%\", $s);\n49 $s = str_replace(\"'\", \"\", $s);\n50 $s = str_replace(\";\", \"\", $s);\n51 $where .= \" AND (`baz` LIKE '%$s%')\";\n52 $orderby = \"ORDER BY `baz` ASC\";\n53 } elseif ($letter!=\"none\" && $letter) {\n54 $where .= \" AND (`baz` LIKE '$letter%'\"\n55 . \" OR `baz` LIKE 'The $letter%')\";\n56 $orderby = \"ORDER BY `baz` ASC\";\n57 } else {\n58 $orderby = \"ORDER BY `item_date` DESC\";\n59 }\n60 $query = mysql_query(\n61 \"SELECT * FROM `items` WHERE $where $orderby\n62 LIMIT $page,\".SEARCHNUM;\n63 );\n64 $count = db_count(\"items\", $where);\n65 ?>\n66\n67 <td align=\"middle\" width=\"480\" valign=\"top\">\n68 <img border=\"0\" width=\"480\" height=\"30\"\n69 src=\"http://example.com/images/example1.gif\">\n70 <table border=\"0\" cellspacing=\"0\" width=\"480\"\n71 cellpadding=\"0\" bgcolor=\"#000000\">\n72 <tr>\n73 <td colspan=\"2\" width=\"480\" height=\"50\">\n74 <img border=\"0\"\n75 src=\"http://example.com/images/example2.gif\">\n76 </td>\n77 </tr>\n78 <tr>\n79 <td width=\"120\" align=\"right\" nowrap>\n80 <img border=\"0\"\n81 src=\"http://example.com/images/example3.gif\">\n82 </td>\n83 <td width=\"360\" align=\"right\" nowrap>\n84 <div class=\"letter\"><?php letter_links(); ?></div>\n85 </td>\n86 </tr>\n87 </table>\n88\n89 <form name=\"search\" enctype=\"multipart/form-data\"\n90 action=\"search.php\" method=\"POST\" margin=\"0\"\n91 style=\"margin: 0px;\">\n92 <table border=\"0\" style=\"border-collapse: collapse\"\n93 width=\"480\" cellpadding=\"0\">\n94 <tr>\n95 <td align=\"center\" width=\"140\">\n96 <input type=\"text\" name=\"s\" size=\"22\"\n97 class=\"user_search\" title=\"enter your search...\"\n98 value=\"<?php\n99 echo $s\n100 ? $s\n101 : \"enter your search...\"\n102 ;\n103 ?>\" onFocus=\" enable(this); \"\n104 onBlur=\" disable(this); \">\n105 </td>\n106 <td align=\"center\" width=\"70\">\n107 <input type=\"image\" name=\"submit\"\n108 src=\"http://example.com/images/user_search.gif\"\n109 width=\"66\" height=\"17\">\n110 </td>\n111 <td align=\"right\" width=\"135\">\n112 <img border=\"0\"\n113 src=\"http://example.com/images/list_foo.gif\"\n114 width=\"120\" height=\"26\">\n115 </td>\n116 <td align=\"center\" width=\"135\">\n117 <select size=\"1\" name=\"p\" onChange=\"submit();\">\n118 <?php\n119 if ($p) {\n120 ${$p} = 'selected=\"selected\"';\n121 }\n122 foreach ($foos as $key => $value) {\n123 echo '<option value=\"'\n124 . $key\n125 . '\" '\n126 . ${$key}\n127 . '>'\n128 . $value\n129 . '</option>';\n130 }\n131 ?>\n132 </select>\n133 </td>\n134 </tr>\n135 </table>\n136 <?php if ($letter) {\n137 echo '<input type=\"hidden\" name=\"letter\" '\n138 . 'value=\"' . $letter . '\">';\n139 } ?>\n140 </form>\n141\n142 <table border=\"0\" cellspacing=\"0\" width=\"480\"\n143 cellpadding=\"0\" style=\"border-style: solid; border-color:\n144 #606875; border-width: 1px 1px 0px 1px;\">\n145 <tr>\n146 <td>\n147 <div class=\"nav\"><?php\n148 $pagecount = ceil(($count / SEARCHNUM));\n149 $currpage = ($page / SEARCHNUM) + 1;\n150 if ($pagecount)\n151 echo ($page + 1)\n152 . \" to \"\n153 . min(($page + SEARCHNUM), $count)\n154 . \" of $count\";\n155 ?></div>\n156 </td>\n157 <td align=\"right\">\n158 <div class=\"nav\"><?php\n159 unset($getstring);\n160 if ($_POST) {\n161 foreach ($_POST as $key => $val) {\n162 if ($key != \"page\") {\n163 $getstring .= \"&$key=$val\";\n164 }\n165 }\n166 }\n167 if ($_GET) {\n168 foreach ($_GET as $key => $val) {\n169 if ($key != \"page\") {\n170 $getstring .= \"&$key=$val\";\n171 }\n172 }\n173 }\n174\n175 if (!$pagecount) {\n176 echo \"No results found!\";\n177 } else {\n178 if ($page >= (3*SEARCHNUM)) {\n179 $firstlink = \" | <a class=\\\"searchresults\\\"\n180 href=\\\"?page=0$getstring\\\">1</a>\";\n181 if ($page >= (4*SEARCHNUM)) {\n182 $firstlink .= \" ... \";\n183 }\n184 }\n185\n186 if ($page >= (2*SEARCHNUM)) {\n187 $prevpages = \" | <a class=\\\"searchresults\\\"\"\n188 . \" href=\\\"?page=\"\n189 . ($page - (2*SEARCHNUM))\n190 . \"$getstring\\\">\"\n191 . ($currpage - 2)\n192 .\"</a>\";\n193 }\n194\n195 if ($page >= SEARCHNUM) {\n196 $prevpages .= \" | <a class=\\\"searchresults\\\"\"\n197 . \" href=\\\"?page=\"\n198 . ($page - SEARCHNUM)\n199 . \"$getstring\\\">\"\n200 . ($currpage - 1)\n201 . \"</a>\";\n202 }\n203\n204 if ($page==0) {\n205 $prevlink = \"&laquo; Previous\";\n206 } else {\n207 $prevnum = $page - SEARCHNUM;\n208 $prevlink = \"<a class=\\\"searchresults\\\"\"\n209 . \" href=\\\"?page=$prevnum$getstring\\\">\"\n210 . \"&laquo; Previous</a>\";\n211 }\n212\n213 if ($currpage==$pagecount) {\n214 $nextlink = \"Next &raquo;\";\n215 } else {\n216 $nextnum = $page + SEARCHNUM;\n217 $nextlink = \"<a class=\\\"searchresults\\\"\"\n218 . \" href=\\\"?page=$nextnum$getstring\\\">\"\n219 . \"Next &raquo;</a>\";\n220 }\n221\n222 if ($page < (($pagecount - 1) * SEARCHNUM))\n223 $nextpages = \" | <a class=\\\"searchresults\\\"\"\n224 . \" href=\\\"?page=\"\n225 . ($page + SEARCHNUM)\n226 . \"$getstring\\\">\"\n227 . ($currpage + 1)\n228 . \"</a>\";\n229\n230 if ($page < (($pagecount - 2)*SEARCHNUM)) {\n231 $nextpages .= \" | <a class=\\\"searchresults\\\"\"\n232 . \" href=\\\"?page=\"\n233 . ($page + (2*SEARCHNUM))\n234 . \"$getstring\\\">\"\n235 . ($currpage + 2)\n236 . \"</a>\";\n237 }\n238\n239 if ($page < (($pagecount - 3)*SEARCHNUM)) {\n240 if ($page < (($pagecount - 4)*SEARCHNUM))\n241 $lastlink = \" ... of \";\n242 else\n243 $lastlink = \" | \";\n244 $lastlink .= \"<a class=\\\"searchresults\\\"\"\n245 . href=\\\"?page=\"\n246 . (($pagecount - 1)*SEARCHNUM)\n247 . \"$getstring\\\">\"\n248 . $pagecount\n249 . \"</a>\";\n250 }\n251\n252 $pagenums = \" | <b>$currpage</b>\";\n253 echo $prevlink\n254 . $firstlink\n255 . $prevpages\n256 . $pagenums\n257 . $nextpages\n258 . $lastlink\n259 . ' | '\n260 . $nextlink;\n261 }\n262 ?></div>\n263 </td>\n264 </tr>\n265 </table>\n266\n267 <table border=\"0\" cellspacing=\"0\" width=\"100%\"\n268 cellpadding=\"0\" style=\"border-style: solid; border-color:\n269 #606875; border-width: 0px 1px 0px 1px;\">\n270\n271 <?php while($item = mysql_fetch_array($query)) {\n272\n273 $links = get_links(\n274 $item[id],\n275 $item[filename],\n276 $item[fileinfotext]\n277 );\n278\n279 $dls = get_dls($item['id']);\n280\n281 echo '\n282 <tr>\n283 <td class=\"bg'.(($ii % 2) ? 1 : 2).'\" align=\"center\">\n284\n285 <div style=\"margin:10px\">\n286 <table border=\"0\" style=\"border-collapse:\n287 collapse\" width=\"458\" id=\"table5\" cellpadding=\"0\">\n288 <tr>\n289 <td rowspan=\"3\" width=\"188\">\n290 <table border=\"0\" cellpadding=\"0\"\n291 cellspacing=\"0\" width=\"174\">\n292 <tr>\n293 <td colspan=\"4\">\n294 <img border=\"0\"\n295 src=\"http://www.example.com/common/'\n296 .$item[thumbnail].'\"\n297 width=\"178\" height=\"74\"\n298 class=\"media_img\">\n299 </td>\n300 </tr>\n301 <tr>\n302 <td style=\"border-color: #565656;\n303 border-style: solid; border-width: 0px\n304 0px 1px 1px;\" width=\"18\">\n305 <a target=\"_blank\"\n306 href=\"'.$links[0][link].'\"\n307 '.$links[0][addlink].'>\n308 <img border=\"0\"\n309 src=\"http://example.com/images/'\n310 .$links[0][type].'.gif\"\n311 width=\"14\" height=\"14\"\n312 hspace=\"3\" vspace=\"3\">\n313 </a>\n314 </td>\n315 <td style=\"border-color: #565656;\n316 border-style: solid; border-width: 0px\n317 0px 1px 0px;\" align=\"left\" width=\"71\">\n318 <a target=\"_blank\"\n319 href=\"'.$links[0][link].'\"\n320 class=\"media_download_link\"\n321 '.$links[0][addlink].'>'\n322 .(round($links[0][filesize]\n323 / 104858) / 10).' MB</a>\n324 </td>\n325 <td style=\"border-color: #565656;\n326 border-style: solid; border-width: 0px\n327 0px 1px 0px;\" width=\"18\">\n328 '.(($links[1][type]) ? '<a\n329 target=\"_blank\"\n330 href=\"'.$links[1][link].'\"\n331 '.$links[1][addlink].'><img\n332 border=\"0\"\n333 src=\"http://example.com/images/'\n334 .$links[1][type].'.gif\"\n335 width=\"14\" height=\"14\" hspace=\"3\"\n336 vspace=\"3\">\n337 </td>\n338 <td style=\"border-color: #565656;\nr339 border-style: solid; border-width: 0px\n340 1px 1px 0px;\" align=\"left\" width=\"71\">\n341 <a target=\"_blank\"\n342 href=\"'.$links[1][link].'\"\n343 class=\"media_download_link\"\n344 '.$links[1][addlink].'>'\n345 .(round($links[1][filesize]\n346 / 104858) / 10).' MB</a>' :\n347 '&nbsp;</td><td>&nbsp;').'\n348 </td>\n349 </tr>\n350 </table>\n351 </td>\n352 <td width=\"270\" valign=\"bottom\">\n353 <div class=\"list_title\">\n354 <a\n355 href=\"page.php?id='.$item[rel_id].'\"\n356 class=\"list_title_link\">'.$item[baz].'</a>\n357 </div>\n358 </td>\n359 </tr>\n360 <tr>\n361 <td align=\"left\" width=\"270\">\n362 <div class=\"media_text\">\n363 '.$item[description].'\n364 </div>\n365 </td>\n366 </tr>\n367 <tr>\n368 <td align=\"left\" width=\"270\">\n369 <div class=\"media_downloads\">'\n370 .number_format($dls)\n371 .' Downloads\n372 </div>\n373 </td>\n374 </tr>\n375 </table>\n376 </div>\n377 </td>\n378 </tr>';\n379 $ii++;\n380 } ?>\n381 </table>\n382\n383 <table border=\"0\" cellspacing=\"0\" width=\"480\"\n384 cellpadding=\"0\" style=\"border-style: solid; border-color:\n385 #606875; border-width: 0px 1px 1px 1px;\">\n386 <tr>\n387 <td>\n388 <div class=\"nav\"><?php\n389 if ($pagecount)\n390 echo ($page + 1)\n391 . \" to \"\n392 . min(($page + SEARCHNUM), $count)\n393 . \" of $count\";\n394 ?></div>\n395 </td>\n396 <td align=\"right\">\n397 <div class=\"nav\"><?php\n398 if (!$pagecount) {\n399 echo \"No search results found!\";\n400 } else {\n401 echo $prevlink\n402 . $firstlink\n403 . $prevpages\n404 . $pagenums\n405 . $nextpages\n406 . $lastlink\n407 . ' | '\n408 . $nextlink;\n409 }\n410 ?></div>\n411 </td>\n412 </tr>\n413 </table>\n414 </td>\n415\n416 <?php include(\"theme/footer.php\"); ?>\n```"]