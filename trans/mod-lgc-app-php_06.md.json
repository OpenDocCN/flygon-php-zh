["```php\n**classes/ItemsGateway.php**\n1 <?php\n2 class ItemsGateway\n3 {\n4 protected $db_host;\n5 protected $db_user;\n6 protected $db_pass;\n7 protected $db;\n8\n9 public function __construct($db_host, $db_user, $db_pass)\n10 {\n11 $this->db_host = $db_host;\n12 $this->db_user = $db_user;\n13 $this->db_pass = $db_pass;\n14 $this->db = new Db($this->db_host, $this->db_user, $this->db_pass);\n15 }\n16\n17 public function selectAll()\n18 {\n19 $rows = $this->db->query(\"SELECT * FROM items ORDER BY id\");\n20 $item_collection = array();\n21 foreach ($rows as $row) {\n22 $item_collection[] = new Item($row);\n23 }\n24 return $item_collection;\n25 }\n26 }\n27 ?>\n```", "```php\n**new\\s+**\n\n```", "```php\n**classes/ItemsGateway.php**\n1 <?php\n2 class ItemsGateway\n3 {\n4 protected $db_host;\n5 protected $db_user;\n6 protected $db_pass;\n7 protected $db;\n8\n9 public function __construct($db_host, $db_user, $db_pass)\n10 {\n11 $this->db_host = $db_host;\n12 $this->db_user = $db_user;\n13 $this->db_pass = $db_pass;\n14 $this->db = new Db($this->db_host, $this->db_user, $this->db_pass);\n15 }\n16 // ...\n17 }\n18 ?>\n```", "```php\nclasses/ItemsGateway.php\n1 <?php\n2 class ItemsGateway\n3 {\n4 protected $db;\n5\n6 public function __construct(Db $db)\n7 {\n8 $this->db = $db;\n9 }\n10\n11 // ...\n12 }\n13 ?>\n```", "```php\n**classes/ItemsGateway.php**\n1 <?php\n2 class ItemsGateway\n3 {\n4 protected $db;\n5\n6 public function __construct(Db $db)\n7 {\n8 $this->db = $db;\n9 }\n10\n11 public function selectAll()\n12 {\n13 $rows = $this->db->query(\"SELECT * FROM items ORDER BY id\");\n14 $item_collection = array();\n15 foreach ($rows as $row) {\n16 $item_collection[] = new Item($row);\n17 }\n18 return $item_collection;\n19 }\n20 }\n21 ?>\n```", "```php\nclasses/ItemFactory.php\n1 <?php\n2 class ItemFactory\n3 {\n4 public function newInstance(array $item_data)\n5 {\n6 return new Item($item_data);\n7 }\n8 }\n9 ?>\n```", "```php\n**classes/ItemsGateway.php**\n1 <?php\n2 class ItemsGateway\n3 {\n4 protected $db;\n5\n6 protected $item_factory;\n7\n8 public function __construct(Db $db, ItemFactory $item_factory)\n9 {\n10 $this->db = $db;\n11 $this->item_factory = $item_factory;\n12 }\n13\n14 public function selectAll()\n15 {\n16 $rows = $this->db->query(\"SELECT * FROM items ORDER BY id\");\n17 $item_collection = array();\n18 foreach ($rows as $row) {\n19 $item_collection[] = $this->item_factory->newInstance($row);\n20 }\n21 return $item_collection;\n22 }\n23 }\n24 ?>\n```", "```php\n**new\\s+ItemsGateway\\(**\n\n```", "```php\n**page_script.php**\n1 <?php\n2 // $db_host, $db_user, and $db_pass are defined in the setup file\n3 require 'includes/setup.php';\n4\n5 // ...\n6\n7 // create a gateway\n8 $items_gateway = new ItemsGateway($db_host, $db_user, $db_pass);\n9\n10 // ...\n11 ?>\n```", "```php\n**page_script.php**\n1 <?php\n2 // $db_host, $db_user, and $db_pass are defined in the setup file\n3 require 'includes/setup.php';\n4\n5 // ...\n6\n7 // create a gateway with its dependencies\n8 $db = new Db($db_host, $db_user, $db_pass);\n9 $item_factory = new ItemFactory;\n10 $items_gateway = new ItemsGateway($db, $item_factory);\n11\n12 // ...\n13 ?>\n```", "```php\n**classes/Service.php**\n1 <?php\n2 class Service\n3 {\n4 public function doThis()\n5 {\n6 // ...\n7 $db = global $db;\n8 $items_gateway = new ItemsGateway($db);\n9 $items = $items_gateway->selectAll();\n10 // ...\n11 }\n12\n13 public function doThat()\n14 {\n15 // ...\n16 $db = global $db;\n17 $items_gateway = new ItemsGateway($db);\n18 $items = $items_gateway->selectAll();\n19 // ...\n20 }\n21 }\n22 ?>\n```", "```php\n**classes/Service.php**\n1 <?php\n2 class Service\n3 {\n4 protected $db;\n5\n6 public function __construct(Db $db)\n7 {\n8 $this->db = $db;\n9 }\n10\n11 public function doThis()\n12 {\n13 // ...\n14 $items_gateway = new ItemsGateway($this->db);\n15 $items = $items_gateway->selectAll();\n16 // ...\n17 }\n18\n19 public function doThat()\n20 {\n21 // ...\n22 $items_gateway = new ItemsGateway($this->db);\n23 $items = $items_gateway->selectAll();\n24 // ...\n25 }\n26 }\n27 ?>\n```", "```php\n**classes/Service.php**\n1 <?php\n2 class Service\n3 {\n4 protected $items_gateway;\n5\n6 public function __construct(ItemsGateway $items_gateway)\n7 {\n8 $this->items_gateway = $items_gateway;\n9 }\n10\n11 public function doThis()\n12 {\n13 // ...\n14 $items = $this->items_gateway->selectAll();\n15 // ...\n16 }\n17\n18 public function doThat()\n19 {\n20 // ...\n21 $items = $this->items_gateway->selectAll();\n22 // ...\n23 }\n24 }\n25 ?>\n```", "```php\n**page_script.php (globals)**\n1 <?php\n2 // defines the $db connection\n3 require 'includes/setup.php';\n4\n5 // creates the service with globals\n6 $service = new Service;\n7 ?>\n```", "```php\n**page_script.php (intermediary dependency)**\n1 <?php\n2 // defines the $db connection\n3 require 'includes/setup.php';\n4\n5 // inject the Db object for the internal ItemsGateway creation\n6 $service = new Service($db);\n7 ?>\n```", "```php\n**page_script.php (real dependency)**\n1 <?php\n2 // defines the $db connection\n3 require 'includes/setup.php';\n4\n5 // create the gateway dependency and then the service\n6 $items_gateway = new ItemsGateway($db);\n7 $service = new Service($items_gateway);\n8 ?>\n```", "```php\n1 <?php\n2 $items_gateway = new ItemsGateway;\n3 ?>\n```", "```php\n1 <?php\n2 $db = new Db($db_host, $db_user, $db_pass);\n3 $item_factory = new ItemFactory;\n4 $items_gateway = new ItemsGateway($db, $item_factory);\n5 ?>\n```", "```php\n**classes/ItemFactory.php**\n1 <?php\n2 class ItemFactory\n3 {\n4 public function newInstance(array $item_data)\n5 {\n6 return new Item($item_data);\n7 }\n8\n9 public function newCollection(array $items_data)\n10 {\n11 $collection = array();\n12 foreach ($items_data as $item_data) {\n13 $collection[] = $this->newInstance($item_data);\n14 }\n15 return $collection;\n16 }\n17 }\n18 ?>\n```", "```php\n**classes/ItemFactory.php**\n1 <?php\n2 class ItemFactory\n3 {\n4 public function newInstance(array $item_data)\n5 {\n6 return new Item($item_data);\n7 }\n8\n9 public function newCollection(array $item_rows)\n10 {\n11 $collection = new ItemCollection;\n12 foreach ($item_rows as $item_data) {\n13 $item = $this->newInstance($item_data);\n14 $collection->append($item);\n15 }\n16 return $collection;\n17 }\n18 }\n19 ?>\n```"]