# 前言

Web 服务一直是一个重要的话题。有了 REST，事情变得更简单更好。如今，RESTful web 服务被广泛使用。十年前它很重要，但是单页应用（SPAs）和移动应用程序大大增加了它的使用。本书的目的是教育 PHP 开发人员有关 RESTful web 服务架构、有效创建 RESTful web 服务的当前工具，如一个名为 Lumen 的微框架、自动化 API 测试、API 测试框架、安全性和微服务架构。

尽管这本书是针对 PHP 的，因为我们将在 PHP7 中构建 RESTful web 服务，但它既不仅仅是关于 PHP7，也不仅仅是关于 REST。RESTful web 服务和在 PHP 中的实现是我们在这本书中要做的。然而，你将学到比这更多。你将了解一些在 PHP7 中是新的 PHP 特性。我们将讨论我们应该如何构建我们的应用程序以及与 web 和 web 服务相关的一些常见威胁。你将学习如何改进基本的 RESTful web 服务，并了解测试的重要性和不同类型的测试。因此，这不仅仅是关于 REST 或 PHP，还涉及一些次要但重要的与编程相关的东西，这些东西简单但在现实世界中能够让事情变得更好。在本书的结尾，你将了解到一个名为微服务的架构。

换句话说，尽管这本书是为 PHP 开发人员而写的，但它将使他们受益不仅仅是在 PHP 方面。因此，这本书不是一本食谱，而是一个旅程，在这个旅程中，你将开始学习关于 RESTful web 服务和 PHP7，然后开始构建 RESTful web 服务。然后，你可以通过了解其中的问题并加以修复来不断改进你的 RESTful web 服务。在这样的改进过程中，你将学到 PHP 中的不同东西，甚至超越 PHP。

# 本书涵盖的内容

第一章《RESTful Web 服务，介绍和动机》向你介绍了 web 服务、REST 架构、RESTful web 服务，以及它与其他 web 服务的比较，如 HTTP 动词和 RESTful 端点。它还通过博客的例子解释了 web 服务，然后讨论了响应格式和响应代码。

第二章《PHP7，更好地编码》包括 PHP7 中的新特性和变化，我们将在本书中使用或者非常重要并值得讨论。

第三章《创建 RESTful 端点》是关于在 Vanilla PHP 中为博客文章的 CRUD 操作创建 REST API 端点。它还解释了通过名为 Postman 的 REST 客户端手动测试 API 端点的方法。

第四章《审查设计缺陷和安全威胁》审查了我们在前一章中构建的内容，并强调其中的问题和缺陷，以便我们以后可以改进。

第五章《使用 Composer 进行加载和解析》，一个进化，是关于 PHP 生态系统中的一个进化工具：composer。这不仅仅是一个自动加载程序或包安装程序，而是一个依赖管理器。因此，你将在本章中了解 composer。

第六章《用 Lumen 照亮 RESTful Web 服务》向你介绍了一个名为 Lumen 的微框架，在这个框架中，我们将重写我们的 RESTful web 服务端点，并审查这个工具将如何显著改进我们的速度和应用程序结构。

第七章《改进 RESTful Web 服务》使我们能够改进前一章中所做的事情；你将学习如何改进 RESTful web 服务。我们将创建身份验证并制作一个转换器来分离 JSON 结构应该如何看起来。此外，我们将在安全性方面进行改进，并了解 SSL。

第八章，API 测试-门上的守卫，介绍了自动化测试的需求。将介绍不同类型的测试，然后专注于 API 测试。然后我们将介绍一个名为 CodeCeption 的自动化测试框架，并在其中编写 API 测试。

第九章，微服务，是关于微服务架构的。我们将了解微服务的好处和挑战，并研究一些可能的解决方案和权衡。

# 你需要为这本书做好准备

尽管我使用了 Ubuntu，但任何安装了 PHP7 的操作系统都可以正常工作。除了 PHP7 之外，唯一需要的是关系型数据库管理系统。本书在连接数据库时使用了与 MySQL 相关的设置，因此 MySQL 是理想的选择，但 MariaDB 或 PostgreSQL 也可以。

# 这本书适合谁

这本书是为以下受众编写的：

+   任何有一些基本 PHP 知识并且想要构建 RESTful 网络服务的人。

+   懂得基本 PHP 并且已经开发了一个基本的动态网站，想要构建 RESTful 网络服务的开发人员。

+   学习了 PHP 并且大部分时间在开源 CMS 中工作，比如 WordPress，并且希望转向开发需要构建网络服务的自定义应用程序的开发人员。

+   被困在 Code Igniter 中的传统系统中，并希望探索 PHP 现代生态系统的开发人员。

+   使用过现代框架如 Yii 或 Laravel，但不确定构建 REST API 所需的关键部分，这些 API 不仅能够实现目的，而且在长期运行中表现良好，不总是需要手动测试，并且易于维护和扩展的开发人员。

+   有经验的 PHP 开发人员，已经创建了一个返回数据的基本 API，但希望熟悉 REST 标准下的 API 构建方式，以及在身份验证出现时的工作方式，以及如何为其编写测试。

# 约定

在这本书中，你会发现一些文本样式，用于区分不同类型的信息。以下是一些这些样式的例子以及它们的含义解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄显示如下：“`randGen()`方法接受两个参数，定义返回值的范围。”

代码块设置如下：

```php
<?php
function add($num1, $num2):int{
    return ($num1+$num2);
}

echo add(2,4); //6
echo add(2.5,4); //6
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目会以粗体显示：

```php
<?php
function add($num1, $num2):int{
    return ($num1+$num2);
}

echo add(2,4); //6
echo add(2.5,4); //6
```

任何命令行输入或输出都以以下方式书写：

```php
sudo add-apt-repository ppa:ondrej/php
```

新术语和重要单词以粗体显示。例如，屏幕上看到的单词，比如菜单或对话框中的单词，会出现在文本中。

警告或重要提示会出现在这样的地方。提示和技巧会出现在这样的地方。
