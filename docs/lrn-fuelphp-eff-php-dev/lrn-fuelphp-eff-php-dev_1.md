# 第一章：什么是 FuelPHP？

FuelPHP 是一种更加社区驱动的框架的新方法。已经有一百多名开发人员在贡献和扩展源代码。还有更多人在为当前可用框架提供一些最好的文档。

由于它是社区驱动的，每个人都处于发现错误、提供修复或向框架添加新功能的平等地位。这导致了一些功能的创建，比如新的临时**ORM**（**对象关系映射器**），这是任何基于 PHP 的 ORM 的首次。这也意味着每个人都可以帮助构建使开发更容易、更直接、更快速的工具。

该框架轻巧，允许开发人员只加载他们需要的内容。这是一种配置优于约定的方法。它不是强制性的约定，而是作为建议和最佳实践。这使得新开发人员可以更快地加入项目并迅速跟上进度。当我们想要为项目找到额外的团队成员时，这也很有帮助。

本章涵盖的主题有：

+   FuelPHP 的简要历史

+   FuelPHP 的特点

+   在第 2 版中可以期待什么

# FuelPHP 的简要历史

FuelPHP 的目标是采纳其他框架的最佳实践，形成一个彻底现代的起点，充分利用 PHP 版本 5.3 的特性，如命名空间。它几乎没有遗留和兼容性问题，这可能会影响旧框架。

该框架始于 2010 年由*Dan Horrigan*创建。他得到了 Phil Sturgeon、Jelmer Schreuder、Harro Verton 和 Frank de Jonge 的加入。FuelPHP 是对其他框架（如 CodeIgniter）的突破，后者基本上仍然是一个 PHP 4 框架。这一突破允许创建一个更现代的 PHP 5.3 框架，并汇集了其他语言和框架（如 Ruby on Rails 和 Kohana）数十年的经验。经过一段时间的社区开发和测试，FuelPHP 框架的 1.0 版本于 2011 年 7 月发布。这标志着一个可以在生产站点上使用的版本，并标志着社区的增长开始。

社区定期发布版本（在撰写本文时，已经到了 1.7 版），并有一个清晰的路线图（[`fuelphp.com/roadmap`](http://fuelphp.com/roadmap)）来添加功能。这也包括迄今为止取得的进展的良好指南。

FuelPHP 的开发是一个开放的过程，所有的代码都托管在 GitHub 上，主要核心包可以在 Fuel GitHub 账户的其他存储库中找到——这些完整的列表可以在[`github.com/fuel/`](https://github.com/fuel/)找到。

# FuelPHP 的特点

使用定制的 PHP 或自定义开发的框架可以提供更好的性能。FuelPHP 提供了许多功能、文档和一个伟大的社区。以下部分描述了一些最有用的功能。

## (H)MVC

尽管 FuelPHP 是一个**Model-View-Controller**（**MVC**）框架，但它是建立在支持 HMVC 变体的 MVC 上的。第三章 *架构*详细介绍了 MVC 设计模式。**Hierarchical Model-View-Controller**（**HMVC**）是一种将逻辑分离然后在多个地方重用控制器逻辑的方法。这意味着当使用主题或模板部分生成网页时，它可以被分割成多个部分或小部件。使用这种方法，可以在项目中或多个项目中重用组件或功能。

除了通常的 MVC 结构外，FuelPHP 还允许使用表示模块（ViewModels）。这是一个强大的层，位于控制器和视图之间，允许更小的控制器，同时仍然将视图逻辑与控制器和视图分离。如果这还不够，FuelPHP 还支持基于路由器的方法，可以直接路由到闭包。然后处理输入 URI 的执行。

## 模块化和可扩展

FuelPHP 的核心已经设计得可以在不需要更改核心代码的情况下进行扩展。它引入了包的概念，这些包是自包含的功能，可以在项目和人员之间共享。与核心一样，在 FuelPHP 的新版本中，这些可以通过**Composer**工具安装。就像包一样，功能也可以分成模块。例如，可以创建一个完整的用户认证模块来处理用户操作，如注册。模块可以包括逻辑和视图，并且可以在项目之间共享。包和模块的主要区别在于，包可以是核心功能的扩展，它们不可路由，而模块是可路由的。包和模块都在第五章、*包*和第六章、*高级主题*中进行了介绍。

## 安全

每个人都希望他们的应用尽可能安全；为此，FuelPHP 为您处理了一些基本问题。FuelPHP 中的视图将对所有输出进行编码，以确保其安全，并且能够避免**跨站脚本**（**XSS**）攻击。这种行为可以被覆盖，也可以通过包含的 htmLawed 库进行清理。

该框架还支持使用令牌进行**跨站请求伪造**（**CSRF**）预防、输入过滤和查询构建器，试图帮助防止 SQL 注入攻击。**PHPSecLib**用于提供框架中的一些安全功能。

## 油-命令行的力量

如果您熟悉 CakePHP、Zend 框架或 Ruby on Rails，那么您将对 FuelPHP Oil 感到满意。它是 FuelPHP 核心的命令行实用程序，旨在加快开发和效率。它还有助于测试和调试。虽然不是必需的，但在开发过程中它被证明是不可或缺的。

Oil 提供了一种快速的方式来进行代码生成、脚手架、运行数据库迁移、调试和类似于 cron 的后台操作任务。它也可以用于自定义任务和后台进程。

Oil 是一个包，可以在[`github.com/fuel/oil`](https://github.com/fuel/oil)找到。

## ORM

FuelPHP 还配备了一个**对象关系映射器**（**ORM**）包，可以通过面向对象的方式与各种数据库进行交互。它相对轻量级，不打算取代像 Doctrine 或 Propel 这样更复杂的 ORM。

ORM 还支持数据关系，如：

+   属于

+   有一个

+   有许多

+   多对多关系

另一个不错的功能是级联删除；在这种情况下，ORM 将删除与单个条目关联的所有数据。

ORM 包可以单独从 FuelPHP 中获取，并托管在 GitHub 上，网址为[`github.com/fuel/orm`](https://github.com/fuel/orm)。

## 基控制器类和模型类

FuelPHP 包括几个类，可以为项目提供一个良好的开端。其中包括帮助模板的控制器，用于构建 RESTful API 的控制器，以及结合了模板和 RESTful API 的控制器。

在模型方面，基类包括**CRUD**（**创建**、**读取**、**更新**和**删除**）操作。有一个用于软删除记录的模型，一个用于嵌套集，最后是一个时间模型。这是一个保留数据修订的简单方法。

## 认证包

身份验证框架为用户身份验证和登录功能提供了良好的基础。可以使用驱动程序来扩展新的身份验证方法。一些基本功能，如组、基本的 ACL 功能和密码哈希，可以直接在身份验证框架中处理。

虽然在安装 FuelPHP 时包含了身份验证包，但它可以单独升级到应用程序的其余部分。代码可以从[`github.com/fuel/auth`](https://github.com/fuel/auth)获取。

## 模板解析器

解析器包使将逻辑与视图分离变得更加容易，而不是将基本的 PHP 嵌入视图中。FuelPHP 支持许多模板语言，如 Twig、Markdown、Smarty 和 HTML 抽象标记语言（Haml）。

## 文档

尽管这不是实际框架的特性，但 FuelPHP 的文档是最好的之一。它会随着每个版本的发布而保持最新，并且可以在[`fuelphp.com/docs/`](http://fuelphp.com/docs/)找到。

# 期待 2.0 版本的内容

尽管本书侧重于 FuelPHP 1.6 及更新版本，但值得期待框架的下一个重大版本。它带来了重大改进，但也对框架的功能方式进行了一些改变。

## 全局范围和转向依赖注入

FuelPHP 的一个很好的特性是全局范围，可以在需要时轻松使用静态语法和实例。版本 2 中最大的变化之一是摆脱静态语法和实例。该框架使用多例设计模式，而不是单例设计模式。现在，大多数多例将被依赖注入容器（DiC）设计模式取代，但这取决于所讨论的类。

更改的原因是允许对核心文件进行单元测试，并根据应用程序的需求动态交换和/或扩展其他类。转向依赖注入将允许对所有核心功能进行隔离测试。

在详细介绍下一个功能之前，让我们更详细地了解设计模式。

## 单例

确保一个类只有一个实例，并为其提供全局访问点。这种思路是一个类或对象的单一实例可能更有效，但它可能会给可能更适合使用不同设计模式的类增加不必要的限制。

## 多例模式

这类似于单例模式，但在此基础上扩展，包括一种以键值对形式管理命名实例映射的方法。因此，这种设计模式确保每个键值对都有一个单一的实例，而不是一个类或对象的单一实例。多例通常被称为单例的注册表。

## 依赖注入容器

这种设计模式旨在消除硬编码的依赖关系，并使其可以在运行时或编译时进行更改。

一个例子是确保变量具有默认值，但也允许它们被覆盖，还允许其他对象传递给类进行操作。

它允许在测试功能时使用模拟对象。

## 编码标准

一个深远的变化将是编码标准的不同。FuelPHP 2.0 现在将符合 PSR-0 和 PSR-1。这允许更标准的自动加载机制和使用 Composer 的能力。虽然 Composer 兼容性是在 1.5 版本中引入的，但这一移动是为了更好的一致性。这意味着方法名称将遵循“驼峰命名法”而不是当前的“蛇形命名法”。虽然这是一个简单的改变，但这可能会对现有项目和 API 产生很大的影响。

随着其他 PHP 框架向更标准化的编码标准迈出类似的步伐，将有更多机会重用其他框架的功能。

## 包管理和模块化

对于其他语言的包管理，比如 Ruby 和 Ruby on Rails，共享代码和功能很容易且很常见。PHP 世界更大，但功能的共享并不那么普遍。**PHP 扩展和应用程序仓库**（**PEAR**）是大多数包管理器的前身。它是一个可重用的 PHP 组件的框架和分发系统。虽然非常有用，但它并没有得到更流行的 PHP 框架的广泛支持。

从 FuelPHP 1.6 开始，一直到 FuelPHP 2.0，依赖管理将通过 Composer（[`getcomposer.org`](http://getcomposer.org)）实现。这不仅涉及单个包，还涉及它们的依赖关系。它允许项目使用每个项目所需的已知版本的库进行一致设置。这不仅有助于开发，还有助于项目的可测试性和可维护性。

它还抗议 API 的更改。FuelPHP 的核心和其他模块将通过 Composer 安装，并且一些 1.0 版本的包将逐渐迁移。

## 向后兼容性

FuelPHP 将发布一个遗留包，为了符合编码标准的变化，它将提供对已更改的函数名称的别名。它还将允许继续使用静态函数调用，同时提供更好的核心功能单元测试能力。

## 速度提升

尽管在最初的 alpha 阶段速度较慢，但 2.0 版本正在变得比 1.0 版本更快。目前（写作时）的 beta 版本比 1.0 版本快 7%，内存占用减少 8%。这听起来可能不多，但如果在多台服务器上运行一个大型网站，这可能会节省大量资源。在 2.0 版本的最终发布后，这些数字可能会更好，因为剩余的优化工作已经完成。

# 总结

我们现在对 FuelPHP 的历史和一些有用的功能有了更多了解，比如 ORM、身份验证、模块、（H）MVC 和 Oil（命令行界面）。

我们还列出了以下有用的链接，包括官方 API 文档（[`fuelphp.com/docs/`](http://fuelphp.com/docs/)）和 FuelPHP 主页（[`fuelphp.com`](http://fuelphp.com)）。

本章还涉及了 FuelPHP 2.0 版本中即将到来的一些新功能和变化。

在下一章中，我们将安装 FuelPHP，并介绍不同的环境和配置。
